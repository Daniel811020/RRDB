
'''
Quick and dirty "library" for various bayer RAW operations.

-SZ

'''

import numpy as np
from copy import deepcopy
import os

bit_chart = [1, 2, 4, 8, 16, 32, 64, 128, 256, 512,
             1024, 2048, 4096, 8192, 16384, 32768, 65536]

# Faster bayer mask generation. No need to use raw_init (or offline maps) anymore!


def bayer_mask_gen(raw_w, raw_h, pattern='RGGB'):
    r_mask = np.zeros((raw_h, raw_w), dtype=np.float32)
    g_mask = np.zeros((raw_h, raw_w), dtype=np.float32)
    b_mask = np.zeros((raw_h, raw_w), dtype=np.float32)

    if pattern == 'BGGR':
        b_mask[0:raw_h:2, 0:raw_w:2] = 1
        g_mask[0:raw_h:2, 1:raw_w:2] = 1
        g_mask[1:raw_h:2, 0:raw_w:2] = 1
        r_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'RGGB':
        r_mask[0:raw_h:2, 0:raw_w:2] = 1
        g_mask[0:raw_h:2, 1:raw_w:2] = 1
        g_mask[1:raw_h:2, 0:raw_w:2] = 1
        b_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'GRBG':
        g_mask[0:raw_h:2, 0:raw_w:2] = 1
        r_mask[0:raw_h:2, 1:raw_w:2] = 1
        b_mask[1:raw_h:2, 0:raw_w:2] = 1
        g_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'GBRG':
        g_mask[0:raw_h:2, 0:raw_w:2] = 1
        b_mask[0:raw_h:2, 1:raw_w:2] = 1
        r_mask[1:raw_h:2, 0:raw_w:2] = 1
        g_mask[1:raw_h:2, 1:raw_w:2] = 1

    return r_mask, g_mask, b_mask


# Generate bayer mask with individual Gr and Gb kernel.
def bayer_mask_gen4(raw_w, raw_h, pattern='RGGB'):
    r_mask = np.zeros((raw_h, raw_w), dtype=np.float32)
    gr_mask = np.zeros((raw_h, raw_w), dtype=np.float32)
    gb_mask = np.zeros((raw_h, raw_w), dtype=np.float32)
    b_mask = np.zeros((raw_h, raw_w), dtype=np.float32)

    if pattern == 'BGGR':
        b_mask[0:raw_h:2, 0:raw_w:2] = 1
        gb_mask[0:raw_h:2, 1:raw_w:2] = 1
        gr_mask[1:raw_h:2, 0:raw_w:2] = 1
        r_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'RGGB':
        r_mask[0:raw_h:2, 0:raw_w:2] = 1
        gr_mask[0:raw_h:2, 1:raw_w:2] = 1
        gb_mask[1:raw_h:2, 0:raw_w:2] = 1
        b_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'GRBG':
        gr_mask[0:raw_h:2, 0:raw_w:2] = 1
        r_mask[0:raw_h:2, 1:raw_w:2] = 1
        b_mask[1:raw_h:2, 0:raw_w:2] = 1
        gb_mask[1:raw_h:2, 1:raw_w:2] = 1

    elif pattern == 'GBRG':
        gb_mask[0:raw_h:2, 0:raw_w:2] = 1
        b_mask[0:raw_h:2, 1:raw_w:2] = 1
        r_mask[1:raw_h:2, 0:raw_w:2] = 1
        gr_mask[1:raw_h:2, 1:raw_w:2] = 1

    return r_mask, gr_mask, gb_mask, b_mask

# Add gaussian noise using noise model.
# raw_buf: QUANTIZED raw buffer
# sigma_s: float[4], Signal dependent noise [R, Gr, Gb, B]
# sigma_c: float[4], "Constant" noise [R, Gr, Gb, B]
# Note 1 - Must be applied to 4-channel Bayer (R, Gr, Gb, B)
# Note 2 - Pixel value range must match the calibrated sensor/value.


def bayer_add_gaussian_noise(raw_buf, sigma_s, sigma_c, bitrate=10, pattern='RGGB', noise_scale=1.0):
    raw_w = raw_buf.shape[1]
    raw_h = raw_buf.shape[0]
    r_mask, gr_mask, gb_mask, b_mask = bayer_mask_gen4(raw_w, raw_h, pattern)
    bayer_mask = [r_mask, gr_mask, gb_mask, b_mask]

    pixel_range = bit_chart[bitrate]
    y_map = [i for i in range(pixel_range)]

    sigma_map = []

    # for i in range(4):
    #     sigma = [sigma_s[i]*np.sqrt(2*y_map[y]) + sigma_c[i]
    #              for y in range(pixel_range)]
    #     sigma_map.append(sigma)

    sigma_map = [
        [0.56, 1.0125483399593906, 1.2000000000000002, 1.343836717690617, 1.465096679918781, 1.5719288512538816, 1.6685125168440815, 1.7573303637676614, 1.84, 1.9176450198781712, 1.9910835055998655, 2.0609330431434976, 2.127673435381234, 2.1916862443496914, 2.253280839081338, 2.3127121840165317, 2.370193359837562, 2.425904606350496, 2.48, 2.5326124809500725, 2.583857702507763, 2.6338370234905155, 2.682639865827456, 2.730345594600086, 2.777025033688163, 2.822741699796952, 2.867552816296953, 2.911510153071851, 2.9546607275353227, 2.997047393876451, 3.038709341572747, 3.0796825196837796, 3.12, 3.1596922894835076, 3.198787600395303, 3.2373120849090418, 3.2752900397563423, 3.3127440854536405, 3.3496953238660314, 3.3861634772249114, 3.422167011199731, 3.4577232442039736, 3.4928484447717376, 3.5275579185586254, 3.561866086286995, 3.5957865537616445, 3.6293321749201404, 3.662515108746451, 3.6953468707624677, 3.727838379715733, 3.7600000000000002, 3.791841580275865, 3.8233724886993823, 3.8546016451158405, 3.8855375505322445, 3.916188314144485, 3.9465616781626762, 3.97666504065002, 4.006505476566082, 4.036089757184069, 4.065424368033064, 4.094515525499924, 4.123369192211214, 4.151991091302984, 4.180386719675123, 4.208561360317241, 4.236520093784339, 4.264267808892873, 4.291809212700993, 4.319148839830634, 4.346291061183754, 4.373240092100155, 4.4, 4.426574711550263, 4.452968019390861, 4.479183588453084, 4.505224961900145, 4.531095566717074, 4.556798718974975, 4.582337628792491, 4.607715405015526, 4.632935059634514, 4.657999511957023, 4.68291159255204, 4.707674046981031, 4.732289539329695, 4.756760655553281, 4.781089906647335, 4.805279731654911, 4.829332500520428, 4.853250516799596, 4.877036020234254, 4.900691189200172, 4.924218143035473, 4.947618944256668, 4.970895600668872, 4.994050067376326, 5.017084248698918, 5.040000000000001, 5.062799129430493, 5.085483399593905, 5.108054529136606, 5.130514194267425, 5.152864030210344, 5.175105632593906, 5.197240558780621, 5.2192703291395315, 5.241196428264894, 5.2630203061437015, 5.284743379274689, 5.306367031741225, 5.32789261624043, 5.349321455070646, 5.370654841079331, 5.39189403857328, 5.413040284192993, 5.434094787752901, 5.455058733049073, 5.4759332786359085, 5.496719558573284, 5.517418683145493, 5.538031739553295, 5.558559792580258, 5.579003885234599, 5.599365039367559, 5.619644256269407, 5.6398425172440145, 5.659960784162953, 5.68, 5.699961089346884, 5.719844958911072, 5.739652497996367, 5.7593845789670155, 5.779042057696028, 5.798625773998369, 5.8181365520495945, 5.8375752007906065, 5.856942514318991, 5.8762392722675685, 5.895466240170581, 5.914624169818083, 5.933713799598932, 5.95273585483287, 5.971691048092085, 5.990580079512684, 6.009403637096449, 6.02816239700322, 6.046857023834319, 6.065488170907281, 6.084056480522262, 6.102562584220408, 6.121007103034485, 6.139390647732062, 6.157713819051489, 6.175977207930959, 6.194181395730883, 6.212326954449823, 6.230414446934192, 6.248444427081976, 6.266417440040643, 6.284334022399461, 6.302194702376436, 6.32, 6.337750427285693, 6.355446488407948, 6.373088679867184, 6.390677490652351, 6.408213402399062, 6.425696889543476, 6.443128419472075, 6.460508452667447, 6.477837442850218, 6.49511583711725, 6.512344076076248, 6.529522593976843, 6.546651818838306, 6.5637321725739906, 6.580764071112569, 6.597747924516225, 6.614684137095841, 6.631573107523289, 6.648415228940943, 6.665210889068453, 6.681960470306878, 6.69866434984028, 6.715322899734829, 6.731936487035492, 6.748505473860389, 6.765030217492901, 6.781511070471547, 6.797948380677736, 6.814342491421462, 6.830693741524936, 6.847002465404319, 6.863268993149507, 6.879493650602079, 6.895676759431465, 6.911818637209347, 6.927919597482369, 6.943979949843202, 6.960000000000001, 6.975980049844296, 6.9919203975173705, 7.007821337475164, 7.02368316055173, 7.039506154021309, 7.055290601659021, 7.071036783800258, 7.086744977398764, 7.102415456083479, 7.118048490214143, 7.133644346935725, 7.14920329023168, 7.164725580976095, 7.180211476984706, 7.19566123306487, 7.211075101064489, 7.226453329919892, 7.241796165702752, 7.257103851666031, 7.272376628288971, 7.287614733321165, 7.302818401825753, 7.317987866221721, 7.333123356325352, 7.3482250993908576, 7.363293320150175, 7.378328240852005, 7.393330081300039, 7.408299058890462, 7.42323538864871, 7.438139283265498, 7.453010953132164, 7.467850606375329, 7.482658448890859, 7.497434684377216, 7.512179514368139, 7.526893138264716, 7.541575753366857, 7.556227554904144, 7.570848736066127, 7.585439488032048, 7.6, 7.614530459215553, 7.629031050999847, 7.64350195877717, 7.657943364102028, 7.672355446685719, 7.686738384422428, 7.701092353414847, 7.715417527999328, 7.729714080770586, 7.7439821826059685, 7.758222002689276, 7.772433708534173, 7.786617466007177, 7.800773439350248, 7.814901791202967, 7.829002682624351, 7.843076273114267, 7.857122720634482, 7.871142181629352, 7.885134811046143, 7.899100762355017, 7.9130401875686776, 7.926953237261657, 7.940840060589309, 7.9547008053064605, 7.968535617785745, 7.982344643035649, 7.9961280247182405, 8.009885905166602, 8.023618425401985, 8.037325725150671, 8.051007942860561, 8.064665215717488, 8.078297679661267, 8.091905469401485, 8.10548871843302, 8.119047559051339, 8.13258212236751, 8.146092538323007, 8.159578935704268, 8.173041442157004, 8.18648018420031, 8.199895287240526, 8.213286875584895, 8.226655072455001, 8.24, 8.253321779309637, 8.266620530427069, 8.279896372361485, 8.293149423100527, 8.306379799622531, 8.31958761790857, 8.332772992954316, 8.345936038781721, 8.359076868450522, 8.37219559406957, 8.38529232680799, 8.39836717690617, 8.41142025368659, 8.424451665564485, 8.43746152005835, 8.45044992380029, 8.463416982546219, 8.476362801185909, 8.489287483752875, 8.502191133434149, 8.515073852579874, 8.527935742712788, 8.540776904537553, 8.55359743794995, 8.566397442045956, 8.579177015130668, 8.591936254727125, 8.604675257584983, 8.61739411968907, 8.630092936267836, 8.642771801801658, 8.655430810031053, 8.668070053964755, 8.680689625887693, 8.693289617368855, 8.705870119269028, 8.718431221748457, 8.73097301427437, 8.74349558562843, 8.755999023914047, 8.768483416563623, 8.780948850345684, 8.79339541137191, 8.805823185104082, 8.818232256360922, 8.830622709324855, 8.842994627548663, 8.855348093962062, 8.86768319087819, 8.88, 8.892298602426584, 8.904579078659392, 8.916841508608382, 8.929085971598093, 8.941312546373629, 8.953521311106561, 8.965712343400767, 8.97788572029818, 8.990041518284475, 9.002179813294669, 9.01430068071866, 9.026404195406691, 9.038490431674733, 9.050559463309824, 9.06261136357531, 9.074646205216046, 9.086664060463507, 9.098665001040855, 9.11064909816793, 9.122616422566178, 9.134567044463529, 9.146501033599193, 9.158418459228418, 9.170319390127174, 9.182203894596787, 9.194072040468507, 9.20592389510803, 9.217759525419957, 9.229578997852203, 9.241382378400344, 9.25316973261192, 9.264941125590685, 9.276696622000792, 9.288436286070947, 9.300160181598505, 9.311868371953501, 9.32356092008266, 9.335237888513337, 9.34689933935743, 9.358545334315213, 9.370175934679171, 9.381791201337743, 9.393391194779047, 9.404975975094564, 9.416545601982751, 9.428100134752652, 9.43963963232743, 9.451164153247875, 9.462673755675876, 9.474168497397837, 9.485648435828066, 9.497113628012123, 9.508564130630122, 9.520000000000001, 9.531421292080761, 9.542828062475648, 9.554220366435327, 9.565598258860986, 9.576961794307438, 9.588311026986167, 9.599646010768343, 9.610966799187809, 9.62227344544403, 9.63356600240501, 9.64484452261017, 9.656109058273213, 9.667359661284934, 9.678596383216005, 9.689819275319747, 9.70102838853485, 9.71222377348806, 9.723405480496867, 9.734573559572128, 9.745728060420687, 9.756869032447947, 9.767996524760422, 9.779110586168278, 9.790211265187812, 9.801298610043938, 9.812372668672616, 9.823433488723282, 9.834481117561241, 9.845515602270023, 9.856536989653728, 9.867545326239352, 9.878540658279064, 9.889523031752482, 9.900492492368912, 9.911449085569574, 9.922392856529788, 9.933323850161159, 9.944242111113716, 9.955147683778048, 9.966040612287404, 9.976920940519785, 9.987788712099992, 9.99864397040168, 10.009486758549377, 10.020317119420469, 10.031135095647196, 10.041940729618595, 10.052734063482449, 10.0635151391472, 10.074283998283844, 10.085040682327818, 10.095785232480859, 10.106517689712831, 10.117238094763572, 10.127946488144675, 10.138642910141291, 10.149327400813887, 10.16, 10.170660747315974, 10.181309682158663, 10.191946843707143, 10.202572270924394, 10.213186002558949, 10.22378807714656, 10.234378533011824, 10.244957408269796, 10.255524740827594, 10.266080568385986, 10.276624928440945, 10.287157858285225, 10.297679395009881, 10.308189575505804, 10.318688436465221, 10.329176014383199, 10.339652345559122, 10.350117466098148, 10.360571411912677, 10.37101421872377, 10.381445922062596, 10.391866557271818, 10.402276159507007, 10.412674763738018, 10.423062404750363, 10.433439117146568, 10.443804935347522, 10.454159893593797, 10.464504025946983, 10.474837366290988, 10.485159948333328, 10.495471805606416, 10.505772971468835, 10.51606347910659, 10.52634336153436, 10.536612651596734, 10.546871381969432, 10.557119585160518, 10.56735729351161, 10.577584539199059, 10.587801354235136, 10.598007770469199, 10.608203819588853, 10.618389533121096, 10.628564942433457, 10.638730078735119, 10.648884973078045, 10.659029656358081, 10.669164159316042, 10.679288512538815, 10.689402746460425, 10.69950689136311, 10.709600977378372, 10.719685034488029, 10.729759092525251, 10.739823181175595, 10.749877329978021, 10.759921568325906, 10.769955925468043, 10.77998043050964, 10.789995112413301, 10.8, 10.809995121950058, 10.819980506804097, 10.829956182963977, 10.839922178693767, 10.849878522120658, 10.859825241235892, 10.869762363895688, 10.879689917822144, 10.889607930604143, 10.899516429698247, 10.909415442429587, 10.919304995992734, 10.929185117452576, 10.939055833745188, 10.948917171678673, 10.95876915793403, 10.96861181906598, 10.978445181503812, 10.988269271552209, 10.998084115392057, 11.007889739081287, 11.017686168555644, 11.02747342962952, 11.037251547996737, 11.047020549231323, 11.056780458788307, 11.066531302004483, 11.07627310409919, 11.086005890175057, 11.095729685218771, 11.105444514101812, 11.115150401581213, 11.124847372300275, 11.134535450789315, 11.144214661466386, 11.153885028637983, 11.16354657649977, 11.173199329137281, 11.182843310526613, 11.192478544535136, 11.20210505492217, 11.211722865339674, 11.221331999332918, 11.230932480341163, 11.240524331698328, 11.250107576633644, 11.259682238272314, 11.269248339636167, 11.278805903644304, 11.288354953113735, 11.29789551076001, 11.307427599197865, 11.316951240941831, 11.326466458406863, 11.335973273908952, 11.345471709665741, 11.35496178779712, 11.364443530325847, 11.373916959178114, 11.38338209618417, 11.392838963078885, 11.402287581502346, 11.41172797300043, 11.42116015902537, 11.43058416093634, 11.440000000000001, 11.449407697391075, 11.458807274192898, 11.46819875139796, 11.477582149908468, 11.486957490536879, 11.496324794006439, 11.505684080951726, 11.515035371919163, 11.524378687367562, 11.533714047668639, 11.543041473107529, 11.552360983883307, 11.561672600109494, 11.570976341814562, 11.580272228942441, 11.589560281353016, 11.598840518822618, 11.608112961044524, 11.617377627629438, 11.626634538105973, 11.63588371192114, 11.645125168440817, 11.654358926950218, 11.663585006654383, 11.672803426678616, 11.68201420606897, 11.691217363792697, 11.700412918738696, 11.709600889717981, 11.718781295464126, 11.727954154633695, 11.737119485806707, 11.746277307487063, 11.755427638102978, 11.764570496007423, 11.773705899478548, 11.782833866720116, 11.791954415861918, 11.80106756496019, 11.810173331998048, 11.819271734885877, 11.828362791461768, 11.837446519491902, 11.846522936670976, 11.855592060622588, 11.864653908899646, 11.873708498984762, 11.882755848290644, 11.891795974160496, 11.900828893868384, 11.909854624619648, 11.918873183551264, 11.927884587732231, 11.936888854163954, 11.945885999780606, 11.95487604144951, 11.963858995971496, 11.972834880081285, 11.98180371044784, 11.990765503674721, 11.999720276300467, 12.008668044798924, 12.017608825579622, 12.026542634988107, 12.035469489306308, 12.044389404752872, 12.053302397483503, 12.062208483591315, 12.071107679107168, 12.08, 12.088885462177167, 12.097764081484765, 12.10663587370798, 12.115500854571385, 12.124359039739298, 12.133210444816081, 12.14205508534647, 12.150892976815895, 12.15972413465079, 12.168548574218915, 12.177366310829662, 12.18617735973437, 12.19498173612662, 12.203779455142563, 12.2125705318612, 12.221354981304703, 12.230132818438701, 12.238904058172583, 12.247668715359792, 12.256426804798123, 12.265178341230007, 12.2739233393428, 12.28266181376909, 12.29139377908695, 12.30011924982025, 12.308838240438925, 12.317550765359256, 12.32625683894415, 12.334956475503423, 12.34364968929406, 12.352336494520499, 12.361016905334896, 12.369690935837399, 12.378358600076409, 12.387019912048851, 12.395674885700435, 12.404323534925918, 12.412965873569368, 12.421601915424409, 12.430231674234502, 12.438855163693175, 12.447472397444296, 12.456083389082307, 12.464688152152497, 12.473286700151224, 12.481879046526181, 12.490465204676639, 12.499045187953685, 12.507619009660463, 12.516186683052421, 12.524748221337548, 12.533303637676614, 12.541852945183397, 12.550396156924924, 12.558933285921713, 12.56746434514798, 12.575989347531896, 12.584508305955799, 12.593021233256428, 12.601528142225138, 12.61002904560815, 12.618523956106737, 12.627012886377475, 12.635495849032452, 12.643972856639492, 12.652443921722359, 12.660909056760984, 12.669368274191681, 12.677821586407353, 12.686269005757707, 12.694710544549467, 12.703146215046578, 12.711576029470416, 12.72, 12.728418138772188, 12.736830457881887, 12.745236969382255, 12.753637685284897, 12.762032617560077, 12.770421778136905, 12.778805178903543, 12.787182831707392, 12.795554748355304, 12.803920940613756, 12.812281420209054, 12.82063619882753, 12.828985288115721, 12.837328699680562, 12.845666445089579, 12.853998535871069, 12.862324983514297, 12.87064579946966, 12.878960995148901, 12.887270581925264, 12.895574571133684, 12.903872974070984, 12.912165801996021, 12.9204530661299, 12.928734777656121, 12.937010947720779, 12.945281587432723, 12.953546707863735, 12.961806320048705, 12.970060434985804, 12.978309063636644, 12.986552216926464, 12.994789905744287, 13.003022140943093, 13.011248933339981, 13.019470293716344, 13.027686232818022, 13.035896761355474, 13.044101890003942, 13.052301629403608, 13.060495990159751, 13.068684982842923, 13.076868617989085, 13.085046906099793, 13.09321985764233, 13.101387483049871, 13.109549792721651, 13.117706797023093, 13.125858506285992, 13.13400493080864, 13.142146080856001, 13.150281966659842, 13.158412598418899, 13.166537986299014, 13.174658140433296, 13.182773070922254, 13.190882787833953, 13.19898730120416, 13.207086621036483, 13.215180757302521, 13.223269719942003, 13.231353518862932, 13.239432163941729, 13.247505665023366, 13.25557403192152, 13.263637274418693, 13.271695402266372, 13.279748425185147, 13.28779635286486, 13.295839194964737, 13.303876961113522, 13.311909660909617, 13.319937303921206, 13.327959899686403, 13.335977457713364, 13.343989987480434, 13.35199749843628, 13.360000000000001, 13.367997501561282, 13.375990012480505, 13.383977542088884, 13.39196009968859, 13.399937694552882, 13.40791033592623, 13.415878033024427, 13.42384079503474, 13.43179863111601, 13.43975155039879, 13.447699561985452, 13.455642674950328, 13.463580898339812, 13.47151424117249, 13.479442712439264, 13.48736632110346, 13.495285076100952, 13.503198986340278, 13.51110806070276, 13.519012308042617, 13.52691173718708, 13.534806356936508, 13.542696176064508, 13.55058120331804, 13.558461447417539, 13.56633691705701, 13.574207620904163, 13.582073567600515, 13.589934765761495, 13.597791223976552, 13.605642950809287, 13.61348995479753, 13.621332244453473, 13.62916982826377, 13.637002714689633, 13.64483091216696, 13.652654429106422, 13.660473273893581, 13.668287454888988, 13.676096980428285, 13.683901858822322, 13.691702098357244, 13.699497707294597, 13.70728869387145, 13.715075066300459, 13.722856832770006, 13.730634001444274, 13.738406580463362, 13.746174577943371, 13.753938001976515, 13.761696860631213, 13.769451161952189, 13.777200913960565, 13.784946124653969, 13.792686802006614, 13.800422953969411, 13.80815458847005, 13.815881713413107, 13.823604336680132, 13.831322466129741, 13.839036109597714, 13.846745274897085, 13.854449969818234, 13.862150202128978, 13.869845979574672, 13.877537309878281, 13.885224200740488, 13.892906659839783, 13.900584694832533, 13.908258313353095, 13.915927523013893, 13.923592331405505, 13.931252746096755, 13.9389087746348, 13.94656042454521, 13.954207703332063, 13.961850618478032, 13.969489177444457, 13.977123387671444, 13.98475325657794, 13.992378791561828, 14.0, 14.007616889248446, 14.01522946664233, 14.022837739496083, 14.03044171510348, 14.038041400737722, 14.045636803651506, 14.05322793107713, 14.060814790226553, 14.068397388291478, 14.07597573244344, 14.083549829833881, 14.091119687594224, 14.098685312835956, 14.106246712650705, 14.113803894110317, 14.12135686426694, 14.128905630153081, 14.136450198781715, 14.14399057714632, 14.151526772220993, 14.159058790960499, 14.166586640300352, 14.174110327156896, 14.18162985842737, 14.189145240989989, 14.19665648170401, 14.20416358740982, 14.211666564928988, 14.21916542106435, 14.22666016260008, 14.234150796301758, 14.241637328916449, 14.249119767172761, 14.256598117780925, 14.264072387432869, 14.271542582802272, 14.279008710544652, 14.286470777297419, 14.293928789679958, 14.301382754293689, 14.308832677722135, 14.316278566530995, 14.323720427268205, 14.331158266464008, 14.33859209063103, 14.34602190626433, 14.353447719841478, 14.360869537822607, 14.368287366650508, 14.375701212750657, 14.383111082531315, 14.39051698238356, 14.397918918681379, 14.40531689778172, 14.412710926024552, 14.420101009732937, 14.42748715521309, 14.434869368754432, 14.442247656629673, 14.449622025094852, 14.456992480389419, 14.464359028736277, 14.471721676341861, 14.479080429396191, 14.486435294072924, 14.493786276529434, 14.501133382906858, 14.508476619330157, 14.515815991908177, 14.523151506733715, 14.530483169883567, 14.537810987418595, 14.545134965383783, 14.552455109808287, 14.55977142670551, 14.567083922073147, 14.574392601893242, 14.581697472132253, 14.588998538741103, 14.596295807655238, 14.603589284794683, 14.610878976064097, 14.618164887352831, 14.625447024534983, 14.632725393469455, 14.64, 14.647270849955289, 14.654537949148954, 14.66180130337965, 14.669060918431105, 14.676316800072177, 14.683568954056904, 14.690817386124555, 14.698062101999694, 14.70530310739222, 14.712540407997428, 14.719774009496055, 14.72700391755434, 14.734230137824067, 14.741452675942618, 14.748671537533033, 14.755886728204056, 14.763098253550176, 14.770306119151693, 14.77751033057476, 14.784710893371438, 14.791907813079737, 14.799101095223675, 14.806290745313323, 14.813476768844856, 14.820659171300605, 14.827837958149091, 14.835013134845097, 14.842184706829695, 14.84935267953031, 14.856517058360753, 14.863677848721286, 14.870835055998656, 14.877988685566141, 14.885138742783612, 14.892285232997564, 14.899428161541172, 14.906567533734334, 14.913703354883715, 14.9208356302828, 14.927964365211936, 14.93508956493837, 14.942211234716309, 14.949329379786956, 14.956444005378552, 14.963555116706432, 14.970662718973058, 14.977766817368076, 14.984867417068346, 14.991964523237993, 14.999058141028453, 15.006148275578512, 15.013234932014354, 15.020318115449605, 15.027397830985363, 15.034474083710261]
        ,[0.01, 0.40597979746446666, 0.5700000000000001, 0.6958571279792899, 0.8019595949289333, 0.8954377448471463, 0.9799484522385713, 1.0576640682967038, 1.1300000000000001, 1.1979393923933999, 1.2621980673998825, 1.3233164127505606, 1.3817142559585798, 1.4377254638059798, 1.491620734196171, 1.5436231610144653, 1.5939191898578666, 1.6426665305566843, 1.6900000000000002, 1.7360359208313134, 1.7808754896942927, 1.824607395554201, 1.867309882599024, 1.9090523952750753, 1.9498969044771426, 1.9898989873223334, 2.029108714259834, 2.0675713839378695, 2.1053281365934073, 2.1424164696418946, 2.1788706738761534, 2.2147222047233073, 2.25, 2.284730753298069, 2.31893915034589, 2.3526480742954115, 2.3858787847867995, 2.4186510747719354, 2.4509834083827773, 2.4828930425717974, 2.5143961347997648, 2.545507838678477, 2.5762423891752704, 2.606613178738797, 2.636632825501121, 2.666313234541439, 2.695665653055123, 2.7247007201531446, 2.7534285119171593, 2.7818585822512665, 2.81, 2.837861382741382, 2.8654509276119593, 2.89277643947636, 2.919845356715714, 2.9466647748764245, 2.9732414683923416, 2.999581910568767, 3.025692291995322, 3.0515785375360602, 3.0772463220289303, 3.1027010848124332, 3.127948043184812, 3.152992204890111, 3.177838379715733, 3.2024911902775863, 3.226955082061296, 3.251234332781263, 3.2753330611133684, 3.2992552348518047, 3.323004678535785, 3.346585080587636, 3.37, 3.3932528726064803, 3.416347016967003, 3.4392856398964495, 3.4620718416626266, 3.48470862087744, 3.507198879103103, 3.52954542519343, 3.551750979388585, 3.5738181771801996, 3.5957495729623954, 3.6175476434830354, 3.639214791108402, 3.660753346913484, 3.6821655736091206, 3.7034536683164174, 3.7246197651980477, 3.7456659379553736, 3.766594202199647, 3.7874065177049716, 3.8081047905501504, 3.8286908751560396, 3.849166576224585, 3.869533650585262, 3.889793808954285, 3.9099487176115537, 3.93, 3.9499492382516808, 3.9697979746446665, 3.989547712994531, 4.009199919983996, 4.028756026434051, 4.048217428519668, 4.067585488933043, 4.08686153799709, 4.106046874731782, 4.125142767875739, 4.144150456865352, 4.163071152773571, 4.181906039210375, 4.200656273186815, 4.219322985944414, 4.23790728375162, 4.256410248668868, 4.274832939283789, 4.29317639141794, 4.311441618806421, 4.3296296137516235, 4.347741347752307, 4.365777772109133, 4.383739818507727, 4.401628399580274, 4.419444409446615, 4.437188724235731, 4.4548622025885125, 4.472465686142584, 4.49, 4.507465953178523, 4.524864339047188, 4.542195935746821, 4.559461506596138, 4.576661800484025, 4.593797552248573, 4.610869483043396, 4.62787830069178, 4.644824700029118, 4.661709363234122, 4.6785329601492585, 4.695296148590823, 4.711999574649067, 4.728643872978761, 4.745229667080574, 4.761757569573599, 4.778228182459393, 4.794642097377817, 4.81099989585503, 4.827302149543871, 4.84354942045698, 4.859742261192857, 4.875881215155175, 4.891966816765555, 4.907999591670053, 4.923980056939589, 4.939908721264523, 4.955786085143595, 4.971612641067418, 4.98738887369673, 5.003115260035562, 5.01879226959953, 5.034420364579382, 5.050000000000001, 5.065531623874981, 5.081015677356954, 5.096452594883786, 5.1118428043208075, 5.127186727099179, 5.142484778350541, 5.157737367038066, 5.172944896084017, 5.1881077624939405, 5.203226357477594, 5.218301066566717, 5.233332269729737, 5.2483203414835184, 5.263265651002242, 5.278168562223498, 5.293029433951698, 5.307848619958861, 5.322626469082878, 5.3373633253233255, 5.3520595279348955, 5.366715411518518, 5.381331306110246, 5.395907537267976, 5.410444426156055, 5.4249422896278405, 5.439401440306289, 5.453822186662603, 5.4682048330930195, 5.482549679993778, 5.496857023834319, 5.51112715722878, 5.525360369005819, 5.5395569442768196, 5.553717164502533, 5.5678413075581785, 5.581929647797072, 5.595982456112801, 5.61, 5.623982543613758, 5.637930347827699, 5.651843670290768, 5.665722765482764, 5.679567884768645, 5.693379276451643, 5.707157185825225, 5.720901855223919, 5.734613524073045, 5.748292428937376, 5.761938803568759, 5.775552878952721, 5.789134883354083, 5.802685042361617, 5.816203578931762, 5.829690713431428, 5.843146663679905, 5.856571644989908, 5.8699658702077775, 5.883329549752849, 5.896662891656019, 5.909966101597534, 5.923239382944005, 5.936482936784683, 5.949696961967, 5.962881655131405, 5.976037210745504, 5.989163821137534, 6.002261676529155, 6.015330965067621, 6.02837187285731, 6.041384583990644, 6.054369280578413, 6.067326142779502, 6.080255348830065, 6.093157075072121, 6.106031495981627, 6.118878784196, 6.131699110541126, 6.144492644057861, 6.157259552028043, 6.17, 6.182714151813609, 6.195402169624867, 6.208064213930023, 6.2207004435892745, 6.233311015850004, 6.2458960863696245, 6.258455809237992, 6.270990336999412, 6.283499820674263, 6.295984409780222, 6.308444252353116, 6.320879494967401, 6.3332902827562805, 6.345676759431466, 6.358039067302595, 6.370377347296307, 6.382691738974984, 6.394982380555173, 6.407249408925684, 6.419492959665375, 6.43171316706064, 6.443910164122593, 6.456084082603949, 6.468235053015646, 6.480363204643153, 6.4924686655625266, 6.504551562656193, 6.51661202162846, 6.5286501670207775, 6.540666122226737, 6.5526600095068375, 6.56463195000299, 6.576582063752802, 6.58851046970361, 6.6004172857263, 6.6123026286288935, 6.624166614169921, 6.63600935707157, 6.647830971032631, 6.659631568741234, 6.671411261887378, 6.683170161175272, 6.694908376335461, 6.706626016136783, 6.718323188398126, 6.73, 6.741656556895933, 6.753292964123686, 6.764909325816299, 6.776505745212961, 6.788082324669715, 6.7996391656699995, 6.811176368835027, 6.822694033934006, 6.834192259894207, 6.845671144810874, 6.857130785956991, 6.868571279792899, 6.879992721975767, 6.891395207368925, 6.902778830051056, 6.914143683325253, 6.925489859727943, 6.93681745103767, 6.948126548283765, 6.95941724175488, 6.97068962100739, 6.981943774873691, 6.993179791470359, 7.004397758206206, 7.015597761790211, 7.026779888239334, 7.037944222886234, 7.04909085038686, 7.0602198547279365, 7.071331319234356, 7.08242532657645, 7.09350195877717, 7.10456129721916, 7.1156034226517315, 7.1266284151977475, 7.137636354360399, 7.1486273190299, 7.159601387490075, 7.170558637424876, 7.181499145924791, 7.19242298949317, 7.203330244052473, 7.21422098495042, 7.225095286966071, 7.235953224315807, 7.246794870659248, 7.2576202991050796, 7.268429582216804, 7.279222792018416, 7.290000000000001, 7.300761277123261, 7.311506693826968, 7.322236320032334, 7.332950225148332, 7.343648478076926, 7.354331147218241, 7.364998300475671, 7.3756500052609075, 7.386286328498915, 7.396907336632835, 7.407513095628828, 7.418103670980854, 7.428679127715392, 7.439239530396096, 7.449784943128398, 7.46031542956404, 7.470831052905568, 7.481331875910747, 7.491817960896937, 7.502289369745406, 7.512746163905588, 7.523188404399294, 7.533616151824866, 7.544029466361278, 7.554428407772189, 7.564813035409943, 7.575183408219527, 7.585539584742463, 7.595881623120677, 7.606209581100301, 7.61652351603543, 7.626823484891849, 7.637109544250692, 7.647381750312079, 7.657640158898692, 7.667884825459313, 7.678115805072326, 7.68833315244917, 7.69853692193775, 7.7087271675258116, 7.718903942844275, 7.729067301170525, 7.739217295431667, 7.7493539782077425, 7.759477401734907, 7.76958761790857, 7.779684678286501, 7.789768634091891, 7.799839536216392, 7.809897435223108, 7.819942381349558, 7.829974424510607, 7.839993614301356, 7.8500000000000005, 7.859993630570665, 7.869974554666192, 7.879942820630911, 7.889898476503362, 7.899841570019008, 7.9097721486128965, 7.9196902594223, 7.929595949289333, 7.939489264763527, 7.949370252104383, 7.959238957283898, 7.969095425989062, 7.978939703624317, 7.9887718353140045, 7.998591865904779, 8.008399839967993, 8.018195801802051, 8.027979795434758, 8.037751864625612, 8.047512052868102, 8.057260403391952, 8.066996959165369, 8.076721762897243, 8.086434857039336, 8.096136283788445, 8.10582608508854, 8.115504302632873, 8.125170977866086, 8.13482615198627, 8.144469865947013, 8.154102160459432, 8.16372307599418, 8.17333265278342, 8.182930930822797, 8.192517949873377, 8.202093749463565, 8.211658368891014, 8.2212118472245, 8.23075422330579, 8.240285535751479, 8.24980582295481, 8.259315123087491, 8.26881347410147, 8.278300913730705, 8.287777479492911, 8.297243208691295, 8.306698138416271, 8.316142305547142, 8.325575746753799, 8.334998498498363, 8.344410597036841, 8.35381207842075, 8.363202978498729, 8.372583332918124, 8.38195317712659, 8.39131254637363, 8.40066147571215, 8.41, 8.419328153901477, 8.428645971888828, 8.437953488243751, 8.447250737058845, 8.45653775223908, 8.46581456750324, 8.475081216385346, 8.484337732236073, 8.493584148224146, 8.502820497337737, 8.512046812385828, 8.521263125999573, 8.530469470633646, 8.539665878567579, 8.548852381907068, 8.5580290125853, 8.567195802364232, 8.57635278283588, 8.585499985423592, 8.5946374413833, 8.603765181804773, 8.612883237612841, 8.621991639568632, 8.631090418270766, 8.640179604156568, 8.649259227503247, 8.65832931842908, 8.667389906894572, 8.67644102270361, 8.685482695504614, 8.694514954791662, 8.703537829905613, 8.71255135003523, 8.721555544218266, 8.730550441342565, 8.739536070147143, 8.748512459223251, 8.757479637015454, 8.766437631822658, 8.775386471799177, 8.784326184955743, 8.793256799160549, 8.802178342140246, 8.81109084148096, 8.819994324629274, 8.82888881889323, 8.83777435144329, 8.84665094931332, 8.855518639401536, 8.864377448471462, 8.873227403152873, 8.882068529942721, 8.890900855206075, 8.899724405177025, 8.908539205959595, 8.917345283528645, 8.926142663730769, 8.934931372285169, 8.943711434784538, 8.952482876695935, 8.961245723361637, 8.97, 8.9787457317063, 8.987482943453584, 8.996211660093481, 9.004931906357045, 9.013643706855575, 9.022347086081407, 9.031042068408729, 9.039728678094376, 9.048406939278626, 9.057076875985967, 9.065738512125888, 9.074391871493642, 9.083036977771004, 9.09167385452704, 9.100302525218838, 9.108923013192276, 9.117535341682732, 9.126139533815836, 9.134735612608182, 9.143323600968051, 9.151903521696125, 9.160475397486188, 9.169039250925831, 9.177595104497145, 9.186142980577408, 9.194682901439768, 9.203214889253923, 9.211738966086791, 9.220255153903175, 9.228763474566426, 9.237263949839086, 9.24575660138356, 9.25424145076274, 9.262718519440652, 9.271187828783088, 9.279649400058236, 9.2881032544373, 9.296549412995121, 9.304987896710786, 9.313418726468244, 9.3218419230569, 9.330257507172215, 9.338665499416303, 9.347065920298517, 9.355458790236037, 9.363844129554439, 9.372221958488273, 9.380592297181646, 9.388955165688767, 9.39731058397452, 9.40565857191501, 9.413999149298133, 9.422332335824102, 9.430658151106005, 9.438976614670333, 9.447287745957523, 9.45559156432248, 9.463888089035116, 9.47217733928085, 9.480459334161148, 9.488734092694024, 9.497001633814554, 9.505261976375376, 9.513515139147199, 9.521761140819297, 9.530000000000001, 9.538231735217192, 9.546456364918786, 9.554673907473214, 9.562884381169908, 9.57108780421977, 9.579284194755635, 9.58747357083276, 9.595655950429267, 9.603831351446617, 9.61199979171006, 9.620161288969088, 9.628315860897894, 9.636463525095808, 9.644604299087742, 9.652738200324636, 9.660865246183889, 9.66898545396979, 9.67709884091396, 9.685205424175757, 9.693305220842728, 9.701398247930998, 9.709484522385715, 9.717564061081442, 9.725636880822584, 9.733702998343789, 9.74176243031035, 9.749815193318609, 9.757861303896359, 9.765900778503234, 9.77393363353111, 9.781959885304483, 9.789979550080869, 9.79799264405118, 9.805999183340106, 9.813999184006496, 9.82199266204373, 9.829979633380102, 9.837960113879179, 9.845934119340168, 9.853901665498292, 9.861862768025143, 9.869817442529046, 9.877765704555413, 9.885707569587103, 9.893643053044764, 9.90157217028719, 9.909494936611667, 9.917411367254314, 9.925321477390435, 9.933225282134837, 9.941122796542192, 9.949014035607357, 9.956899014265703, 9.96477774739346, 9.97265024980803, 9.98051653626832, 9.988376621475059, 9.996230520071125, 10.00407824664186, 10.01191981571538, 10.019755241762908, 10.02758453919906, 10.03540772238217, 10.043224805614594, 10.051035803143021, 10.058840729158764, 10.066639597798064, 10.074432423142401, 10.082219219218771, 10.090000000000002, 10.09777477940502, 10.10554357129917, 10.11330638949448, 10.121063247749962, 10.128814159771887, 10.13655913921407, 10.144298199678161, 10.152031354713909, 10.159758617819442, 10.16748000244155, 10.175195521975954, 10.182905189767572, 10.190609019110793, 10.198307023249743, 10.20599921537855, 10.213685608641615, 10.221366216133864, 10.22904105090101, 10.236710125939819, 10.244373454198358, 10.252031048576255, 10.25968292192495, 10.267329087047953, 10.274969556701082, 10.28260434359272, 10.29023346038406, 10.29785691968935, 10.305474734076132, 10.313086916065496, 10.320693478132302, 10.328294432705437, 10.335889792168034, 10.343479568857724, 10.351063775066859, 10.358642423042744, 10.366215524987881, 10.37378309306018, 10.381345139373197, 10.388901675996358, 10.396452714955188, 10.403998268231529, 10.411538347763758, 10.41907296544702, 10.426602133133434, 10.434125862632321, 10.441644165710409, 10.44915705409206, 10.456664539459474, 10.464166633452905, 10.471663347670868, 10.479154693670354, 10.486640682967037, 10.494121327035472, 10.501596637309309, 10.509066625181498, 10.516531302004484, 10.523990679090408, 10.531444767711324, 10.538893579099375, 10.546337124446996, 10.55377541490713, 10.561208461593393, 10.56863627558029, 10.576058867903397, 10.583476249559556, 10.590888431507064, 10.598295424665862, 10.605697239917722, 10.613093888106434, 10.620485380037994, 10.627871726480784, 10.635252938165756, 10.642629025786615, 10.65, 10.657365871425664, 10.664726650646651, 10.672082348209473, 10.679432974624284, 10.686778540365067, 10.694119055869791, 10.7014545315406, 10.708784977743969, 10.716110404810891, 10.723430823037036, 10.730746242682923, 10.738056673974091, 10.745362127101256, 10.752662612220492, 10.759958139453381, 10.767248718887187, 10.774534360575009, 10.781815074535952, 10.789090870755288, 10.796361759184606, 10.803627749741974, 10.810888852312111, 10.818145076746518, 10.825396432863663, 10.832642930449106, 10.839884579255681, 10.847121389003632, 10.854353369380767, 10.861580530042616, 10.868802880612579, 10.876020430682063, 10.883233189810657, 10.890441167526252, 10.897644373325207, 10.904842816672483, 10.912036507001801, 10.91922545371577, 10.92640966618604, 10.93358915375345, 10.940763925728158, 10.947933991389782, 10.955099359987557, 10.96226004074045, 10.969416042837318, 10.976567375437039, 10.983714047668638, 10.990856068631444, 10.997993447395206, 11.005126193000242, 11.01225431445756, 11.019377820749002, 11.026496720827362, 11.033611023616537, 11.040720738011638, 11.047825872879136, 11.054926437056972, 11.06202243935471, 11.06911388855364, 11.076200793406924, 11.083283162639708, 11.090361004949253, 11.097434329005067, 11.104503143449014, 11.111567456895447, 11.11862727793133, 11.125682615116357, 11.132733476983075, 11.139779872037003, 11.146821808756753, 11.153859295594144, 11.160892340974332, 11.167920953295916, 11.174945140931056, 11.181964912225602, 11.188980275499194, 11.19599123904538, 11.202997811131745, 11.21, 11.216997813866122, 11.223991260920442, 11.230980349327773, 11.237965087227517, 11.244945482733772, 11.25192154393545, 11.258893278896373, 11.265860695655398, 11.27282380222651, 11.27978260659894, 11.286737116737271, 11.293687340581537, 11.300633286047335, 11.30757496102593, 11.314512373384357, 11.321445530965528, 11.328374441588334, 11.335299113047745, 11.342219553114916, 11.34913576953729, 11.356047770038694, 11.362955562319446, 11.369859154056446, 11.376758552903286, 11.383653766490346, 11.390544802424882, 11.397431668291143, 11.40431437165045, 11.411192920041307, 11.418067320979484, 11.424937581958126, 11.431803710447838, 11.438665713896789, 11.445523599730798, 11.452377375353429, 11.45922704814609, 11.46607262546812, 11.472914114656884, 11.479751523027865, 11.486584857874751, 11.493414126469531, 11.500239336062588, 11.507060493882774, 11.513877607137518, 11.520690683012901, 11.527499728673755, 11.53430475126374, 11.541105757905441, 11.54790275570045, 11.55469575172945, 11.56148475305231, 11.568269766708166, 11.575050799715495, 11.581827859072224, 11.588600951755787, 11.595370084723234, 11.602135264911293, 11.60889649923647, 11.615653794595117, 11.622407157863524, 11.629156595898001, 11.63590211553495, 11.642643723590956, 11.649381426862856, 11.656115232127837, 11.662845146143496, 11.669571175647928, 11.67629332735981, 11.683011607978466, 11.689726024183958, 11.696436582637157, 11.703143289979817, 11.709846152834661, 11.71654517780545, 11.72324037147706, 11.729931740415555, 11.736619291168278, 11.7433030302639, 11.749982964212514, 11.756659099505699, 11.7633314426166, 11.770000000000001, 11.77666477809239, 11.783325783312039, 11.789983022059074, 11.796636500715545, 11.803286225645506, 11.809932203195068, 11.816574439692488, 11.823212941448235, 11.829847714755044, 11.83647876588801, 11.843106101104647, 11.849729726644947, 11.856349648731461, 11.862965873569367, 11.869578407346529, 11.876187256233573, 11.882792426383947, 11.889393923934, 11.89599175500303, 11.90258592569337, 11.909176442090438, 11.91576331026281, 11.922346536262284, 11.928926126123947, 11.93550208586624, 11.942074421491009, 11.948643138983593, 11.955208244312864, 11.961769743431306, 11.968327642275069, 11.97488194676404, 11.981432662801891, 11.987979796276166, 11.99452335305831, 12.00106333900376, 12.007599759951988, 12.01413262172657, 12.020661930135242, 12.027187690969964, 12.033709910006978, 12.04022859300687, 12.04674374571462, 12.05325537385968, 12.059763483156008, 12.066268079302152, 12.072769167981289, 12.079266754861292, 12.085760845594782, 12.092251445819194, 12.098738561156827, 12.1052221972149, 12.111702359585614, 12.118179053846207, 12.124652285559005, 12.131122060271483, 12.13758838351632, 12.144051260811453, 12.15051069766013, 12.156966699550964, 12.163419271957997, 12.169868420340741, 12.176314150144242, 12.182756466799129, 12.189195375721667, 12.195630882313809, 12.202062991963254, 12.208491710043502, 12.214917041913887, 12.221338992919655, 12.227757568392, 12.23417277364812, 12.240584613991272, 12.24699309471081, 12.253398221082252, 12.25979999836732, 12.266198431814002, 12.272593526656587, 12.278985288115722, 12.285373721398466, 12.291758831698333, 12.298140624195348, 12.304519104056086, 12.310894276433727, 12.31726614646811, 12.323634719285774, 12.33, 12.336361993710879, 12.342720705505334, 12.349076140457194, 12.355428303627217, 12.361777200063155, 12.36812283479979, 12.374465212858986, 12.380804339249734, 12.387140218968193, 12.39347285699775, 12.399802258309048, 12.406128427860047, 12.412451370596058, 12.418771091449791, 12.425087595341404, 12.43140088717855, 12.437710971856404, 12.444017854257732, 12.450321539252915, 12.456622031700007, 12.46291933644477, 12.469213458320715, 12.475504402149157, 12.48179217273925, 12.488076774888029, 12.494358213380456, 12.500636492989461, 12.506911618475984, 12.513183594589021, 12.51945242606566, 12.525718117631126, 12.531980673998824, 12.538240099870373, 12.54449639993566, 12.550749578872868, 12.556999641348526, 12.563246592017542, 12.569490435523251, 12.57573117649745, 12.581968819560444, 12.588203369321073, 12.59443483037677, 12.600663207313586, 12.606888504706232, 12.613110727118128, 12.619329879101427, 12.625545965197068, 12.631758989934802, 12.637968957833243, 12.644175873399897, 12.650379741131198, 12.656580565512561, 12.662778351018405, 12.668973102112194, 12.67516482324648]
        ,[0.09, 0.4435533905932738, 0.59, 0.7023724356957944, 0.7971067811865475, 0.8805694150420948, 0.9560254037844386, 1.0254143466934853, 1.09, 1.1506601717798213, 1.208033988749895, 1.2626039399558575, 1.314744871391589, 1.3647548783981962, 1.4128756555322954, 1.4593063937629154, 1.5042135623730952, 1.5477379737113253, 1.59, 1.631103500742244, 1.6711388300841898, 1.7101851746019652, 1.7483123951777, 1.7855824957813171, 1.8220508075688773, 1.857766952966369, 1.8927756377319946, 1.9271173070873837, 1.9608286933869707, 1.9939432764659772, 2.0264916731037084, 2.0585019685029526, 2.09, 2.12100960115899, 2.15155281280883, 2.1816500663351888, 2.2113203435596422, 2.2405813167606565, 2.269449471770337, 2.297940216581962, 2.3260679774997897, 2.353846284534354, 2.3812878474779198, 2.408404623873926, 2.4352078799117147, 2.4617082451262844, 2.4879157616563594, 2.5138399287081645, 2.5394897427831777, 2.564873734152916, 2.59, 2.614876234590519, 2.639509756796392, 2.66390753524675, 2.688076211353316, 2.7120221204253787, 2.7357513110645906, 2.7592695630078277, 2.7825824035672517, 2.8056951228000537, 2.8286127875258305, 2.851340254296815, 2.8738821814150106, 2.896243040080456, 2.91842712474619, 2.9404385627478447, 2.962281323269014, 2.9839592256975562, 3.0054759474226502, 3.0268350311176824, 3.048039891549808, 3.069093821953246, 3.09, 3.110761493398643, 3.1313812651491095, 3.1518621784789724, 3.172207001484488, 3.192418411497714, 3.212498999199199, 3.2324512724941337, 3.2522776601683794, 3.2719805153394637, 3.291562118716424, 3.3110246816812814, 3.33037034920393, 3.3496012026013244, 3.368719262151, 3.3877264895682297, 3.4066247903553997, 3.4254160160315834, 3.4441019662496846, 3.4626843908080103, 3.481164991562634, 3.4995454242464636, 3.517827300200522, 3.5360121880225552, 3.5541016151377542, 3.5720970692960297, 3.59, 3.607811819867572, 3.6255339059327376, 3.6431676008879736, 3.660714214271425, 3.6781750236018307, 3.695551275463989, 3.7128441865473594, 3.730054944640259, 3.747184709581948, 3.764234614174767, 3.78120576505835, 3.7980992435478313, 3.8149161064378347, 3.831657386773941, 3.848324094593227, 3.8649172176353748, 3.881437722025775, 3.897886552931954, 3.9142646351945887, 3.9305728739343038, 3.946812155135378, 3.962983346207417, 3.979087296526011, 3.995124837953327, 4.0110967853395305, 4.027003937005905, 4.042847075210474, 4.058626966596886, 4.074344362627307, 4.09, 4.105594601052252, 4.121128874149274, 4.1366035140596615, 4.15201920231798, 4.167376607575022, 4.182676385936225, 4.1979191812887455, 4.21310562561766, 4.228236339311712, 4.243311931459037, 4.258333000133266, 4.273300132670378, 4.288213905936666, 4.303074886588179, 4.317883631321941, 4.332640687119285, 4.3473465914816005, 4.362001872658765, 4.376607049870562, 4.391162633521313, 4.405669125408017, 4.4201270189221935, 4.434536799245691, 4.448898943540674, 4.463213921133975, 4.477482193696061, 4.491704215414752, 4.505880433163924, 4.520011286667337, 4.534097208657794, 4.5481386250317515, 4.5621359549995795, 4.57608961123159, 4.59, 4.603867521316947, 4.6176925690687085, 4.631475531146237, 4.6452167895721495, 4.6589167206242665, 4.67257569495584, 4.686194077712559, 4.699772228646443, 4.713310502226732, 4.726809247747852, 4.740268809434569, 4.753689526544408, 4.767071733467427, 4.78041575982343, 4.7937219305566945, 4.806990566028301, 4.820221982106125, 4.833416490252569, 4.846574397610111, 4.859696007084728, 4.872781617427248, 4.885831523312719, 4.898846015417836, 4.911825380496477, 4.924769901453429, 4.937679857416329, 4.950555523805895, 4.963397172404481, 4.976205071423016, 4.988979485566356, 5.001720676097125, 5.014428900898052, 5.027104414532874, 5.0397474683058325, 5.052358310319802, 5.0649371855331, 5.077484335815001, 5.09, 5.102484413940855, 5.114937810560445, 5.127360419902471, 5.139752469181039, 5.152114182829147, 5.164445782546109, 5.176747487343951, 5.189019513592784, 5.201262075065218, 5.213475382979799, 5.2256596460435345, 5.2378150704935, 5.249941860137573, 5.2620402163943005, 5.27411033833193, 5.286152422706632, 5.298166663999915, 5.310153254455275, 5.322112384114087, 5.334044240850758, 5.34594901040716, 5.357826876426369, 5.369678020485718, 5.381502622129181, 5.3933008588991065, 5.405072906367325, 5.416818938165629, 5.4285391260156555, 5.440233639758174, 5.451902647381804, 5.463546315051169, 5.475164807134504, 5.486758286230725, 5.498326913195984, 5.5098708471697, 5.521390245600108, 5.53288526426931, 5.544356057317857, 5.555802777268862, 5.567225575051661, 5.578624600025037, 5.59, 5.60135192126215, 5.61268050859363, 5.6239859052946635, 5.635268253204709, 5.646527692723217, 5.657764362830021, 5.668978401105349, 5.680169943749474, 5.69133912560202, 5.702486080160912, 5.713610939600996, 5.724713834792322, 5.735794895318107, 5.74685424949238, 5.757892024377317, 5.7689083458002735, 5.779903338370521, 5.7908771254956894, 5.801829829397931, 5.812761571129799, 5.823672470589857, 5.8345626465380285, 5.845432216610669, 5.856281297335398, 5.867110004145672, 5.877918451395113, 5.888706752371601, 5.899475019311125, 5.910223363411408, 5.920951894845301, 5.9316607227739615, 5.942349955359813, 5.953019699779287, 5.963670062235365, 5.97430114796991, 5.9849130612757975, 5.995505905508858, 6.006079783099616, 6.0166347955648485, 6.027171043518958, 6.037688626685159, 6.048187643906492, 6.058668193156661, 6.069130371550699, 6.079574275355469, 6.09, 6.1004076400856535, 6.110797289396148, 6.121169040907409, 6.131522986797286, 6.141859218455102, 6.15217782649107, 6.162478900745559, 6.172762530298219, 6.1830288034769705, 6.193277807866851, 6.203509630318742, 6.213724356957945, 6.223922073192648, 6.234102863722254, 6.244266812545585, 6.254414002968976, 6.264544517614234, 6.27465843842649, 6.284755846681933, 6.294836822995428, 6.304901447328026, 6.314949798994366, 6.324981956669963, 6.334997998398398, 6.344998001598402, 6.354982043070834, 6.364950199005566, 6.3749025449882675, 6.384839156007086, 6.394760106459246, 6.4046654701575445, 6.414555320336759, 6.4244297296599635, 6.43428877022476, 6.444132513569417, 6.4539610306789275, 6.463774391990981, 6.473572667401852, 6.4833559262722105, 6.493124237432848, 6.50287766919033, 6.5126162893325645, 6.522340165134303, 6.532049363362563, 6.54174395028197, 6.551423991660043, 6.561089552772392, 6.57074069840786, 6.580377492873585, 6.59, 6.599608283145768, 6.609202405202649, 6.618782428600298, 6.62834841531101, 6.637900426854397, 6.647438524302, 6.656962768281849, 6.6664732189829525, 6.6759699361597455, 6.68545297913646, 6.694922406811453, 6.704378277661476, 6.713820649745885, 6.7232495807107995, 6.7326651277932115, 6.742067347825035, 6.751456297237114, 6.760832032063167, 6.770194607943694, 6.779544080129826, 6.788880503487131, 6.798203932499369, 6.807514421272201, 6.816812023536855, 6.82609679265374, 6.835368781616021, 6.844628043053148, 6.853874629234341, 6.863108592072033, 6.872329983125268, 6.881538853603062, 6.890735254367722, 6.899919235938118, 6.909090848492927, 6.918250141873831, 6.927397165588672, 6.936531968814577, 6.945654600401044, 6.954765108872991, 6.96386354243376, 6.972949948968102, 6.982024376045111, 6.99108687092113, 7.000137480542627, 7.0091762515490235, 7.018203230275509, 7.027218462755804, 7.036221994724902, 7.045213871621778, 7.0541941385920595, 7.063162840490676, 7.07212002188447, 7.081065727054781, 7.09, 7.098922884438093, 7.107834423809099, 7.116734661277598, 7.125623639735144, 7.1345014018026855, 7.143367989832942, 7.152223445912767, 7.161067811865475, 7.169901129253148, 7.1787234393789126, 7.187534783289195, 7.196335201775947, 7.2051247353788535, 7.213903424387503, 7.222671308843553, 7.23142842854285, 7.240174823037545, 7.248910531638177, 7.257635593415725, 7.2663500472036615, 7.275053931599957, 7.283747284969079, 7.292430145443967, 7.301102550927978, 7.309764539096825, 7.31841614740048, 7.327057413065064, 7.335688373094719, 7.344309064273454, 7.352919523166975, 7.361519786124493, 7.370109889280518, 7.378689868556625, 7.387259759663212, 7.3958195981012285, 7.4043694191638965, 7.412909257938405, 7.42143914930759, 7.429959127951599, 7.438469228349534, 7.44696948478108, 7.455459931328117, 7.463940601876312, 7.4724115301167, 7.480872749547241, 7.489324293474371, 7.497766195014527, 7.506198487095663, 7.514621202458748, 7.523034373659253, 7.531438033068608, 7.53983221287567, 7.548216945088149, 7.556592261534039, 7.564958193863027, 7.5733147735478825, 7.581662031885848, 7.59, 7.5983287088406035, 7.606648189186454, 7.614958471646205, 7.623259586659682, 7.631551564499178, 7.63983443527075, 7.648108228915487, 7.656372975210778, 7.664628703771558, 7.6728754440515505, 7.681113225344488, 7.689342076785332, 7.697562027351469, 7.7057731058639085, 7.713975340988453, 7.7221687612368735, 7.730353394968063, 7.7385292703891775, 7.7466964155567775, 7.7548548583779455, 7.763004626611403, 7.771145747868608, 7.779278249614849, 7.787402159170326, 7.7955175037112205, 7.803624310270756, 7.8117226057402505, 7.819812416870153, 7.82789377027108, 7.835966692414834, 7.8440312096354115, 7.852087348130012, 7.860135133960027, 7.868174593052022, 7.876205751198718, 7.884228634059948, 7.892243267163617, 7.900249675906654, 7.908247885555944, 7.916237921249264, 7.924219807996199, 7.932193570679061, 7.940159234053791, 7.948116822750856, 7.956066361276137, 7.964007874011811, 7.971941385217223, 7.9798669190297495, 7.987784499465657, 7.995694150420948, 8.003595895672207, 8.01148975887743, 8.019375763576853, 8.027253933193773, 8.035124291035352, 8.042986860293434, 8.050841664045329, 8.058688725254614, 8.066528066771909, 8.074359711335656, 8.082183681572891, 8.09, 8.097808689023482, 8.1056097709407, 8.113403267940607, 8.121189202104505, 8.128967595406763, 8.13673846971554, 8.144501846793506, 8.152257748298549, 8.160006195784486, 8.167747210701755, 8.175480814398114, 8.183207028119323, 8.190925873009824, 8.198637370113428, 8.206341540373963, 8.21403840463596, 8.221727983645296, 8.229410298049853, 8.237085368400162, 8.244753215150045, 8.252413858657254, 8.260067319184095, 8.267713616898062, 8.27535277187245, 8.28298480408697, 8.290609733428363, 8.298227579691002, 8.305838362577491, 8.313442101699263, 8.321038816577165, 8.32862852664204, 8.336211251235321, 8.343787009609589, 8.351355820929152, 8.358917704270613, 8.366472678623424, 8.374020762890446, 8.3815619758885, 8.389096336348915, 8.396623862918075, 8.404144574157945, 8.41165848854662, 8.419165624478842, 8.426666000266533, 8.434159634139318, 8.441646544245033, 8.449126748650244, 8.456600265340755, 8.464067112222112, 8.471527307120105, 8.478980867781258, 8.486427811873332, 8.493868156985805, 8.501301920630361, 8.508729120241368, 8.516149773176359, 8.5235638967165, 8.530971508067067, 8.538372624357901, 8.545767262643881, 8.553155439905378, 8.560537173048708, 8.567912478906585, 8.57528137423857, 8.582643875731515, 8.59, 8.597349763586777, 8.604693182963201, 8.612030274529655, 8.61936105461599, 8.626685539481937, 8.63400374531753, 8.641315688243536, 8.648621384311845, 8.655920849505907, 8.663214099741124, 8.670501150865256, 8.677782018658833, 8.685056718835542, 8.692325267042627, 8.699587678861281, 8.706843969807043, 8.71409415533017, 8.721338250816034, 8.728576271585498, 8.735808232895291, 8.74303414993839, 8.750254037844387, 8.757467911679857, 8.764675786448736, 8.771877677092668, 8.779073598491383, 8.786263565463043, 8.793447592764606, 8.800625695092172, 8.807797887081348, 8.814964183307573, 8.82212459828649, 8.829279146474267, 8.83642784226795, 8.843570700005799, 8.850707733967615, 8.85783895837509, 8.864964387392122, 8.872084035125148, 8.879197915623473, 8.88630604287959, 8.893408430829504, 8.900505093353047, 8.907596044274198, 8.914681297361396, 8.921760866327848, 8.928834764831844, 8.935903006477066, 8.942965604812887, 8.950022573334675, 8.9570739254841, 8.964119674649424, 8.971159834165805, 8.978194417315589, 8.985223437328598, 8.992246907382428, 8.99926484060273, 9.006277250063503, 9.013284148787374, 9.020285549745875, 9.027281465859739, 9.034271909999159, 9.041256894984079, 9.048236433584458, 9.055210538520553, 9.06217922246318, 9.069142498033985, 9.076100377805714, 9.083052874302474, 9.09, 9.09694176732591, 9.103878188659973, 9.110809276334358, 9.117735042633894, 9.124655499796326, 9.131570660012562, 9.138480535426929, 9.145385138137417, 9.152284480195929, 9.159178573608527, 9.166067430335673, 9.172951062292475, 9.179829481348921, 9.186702699330127, 9.193570728016562, 9.200433579144299, 9.207291264405235, 9.21414379544733, 9.220991183874837, 9.227833441248533, 9.234670579085941, 9.241502608861563, 9.2483295420071, 9.25515138991168, 9.26196816392207, 9.26877987534291, 9.275586535436918, 9.282388155425117, 9.289184746487049, 9.295976319760983, 9.302762886344139, 9.309544457292887, 9.316321043622967, 9.323092656309694, 9.329859306288164, 9.336621004453464, 9.343377761660873, 9.350129588726068, 9.356876496425318, 9.363618495495704, 9.370355596635292, 9.377087810503355, 9.383815147720552, 9.390537618869137, 9.397255234493143, 9.403968005098578, 9.410675941153624, 9.417379053088816, 9.424077351297235, 9.430770846134703, 9.437459547919959, 9.444143466934854, 9.450822613424528, 9.457496997597596, 9.464166629626337, 9.47083151964686, 9.477491677759293, 9.484147114027968, 9.490797838481583, 9.49744386111339, 9.504085191881366, 9.510721840708387, 9.517353817482402, 9.523981132056603, 9.530603794249602, 9.537221813845592, 9.543835200594518, 9.550443964212251, 9.557048114380743, 9.563647660748208, 9.57024261292927, 9.576832980505138, 9.583418773023762, 9.59, 9.596576670915772, 9.603148795220223, 9.609716382329886, 9.616279441628825, 9.622837982468809, 9.629392014169456, 9.635941546018392, 9.6424865872714, 9.64902714715258, 9.655563234854496, 9.662094859538323, 9.668622030334008, 9.675144756340407, 9.681663046625438, 9.688176910226233, 9.694686356149273, 9.701191393370543, 9.707692030835672, 9.714188277460078, 9.720680142129112, 9.72716763369819, 9.733650760992955, 9.74012953280939, 9.746603957913983, 9.753074045043844, 9.759539802906858, 9.766001240181813, 9.772458365518542, 9.77891118753805, 9.785359714832659, 9.791803955966127, 9.7982439194738, 9.804679613862724, 9.81111104761179, 9.81753822917186, 9.823961166965892, 9.830379869389079, 9.836794344808963, 9.84320460156558, 9.849610647971568, 9.856012492312304, 9.862410142846032, 9.868803607803972, 9.875192895390462, 9.88157801378307, 9.887958971132711, 9.894335775563789, 9.900708435174291, 9.90707695803593, 9.91344135219425, 9.91980162566875, 9.926157786453, 9.932509842514763, 9.938857801796104, 9.945201672213512, 9.95154146165801, 9.957877177995275, 9.964208829065749, 9.970536422684752, 9.976859966642595, 9.983179468704689, 9.989494936611665, 9.995806378079475, 10.002113800799505, 10.008417212438687, 10.014716620639604, 10.021012033020602, 10.027303457175895, 10.033590900675671, 10.0398743710662, 10.046153875869939, 10.052429422585638, 10.058701018688442, 10.064968671630002, 10.071232388838565, 10.077492177719089, 10.083748045653342, 10.09, 10.09624804809475, 10.102492197250394, 10.10873245475694, 10.114968827881711, 10.121201323869439, 10.127429949942366, 10.133654713300333, 10.13987562112089, 10.146092680559383, 10.152305898749054, 10.158515282801133, 10.164720839804943, 10.170922576827977, 10.177120500916008, 10.183314619093174, 10.189504938362077, 10.195691465703868, 10.201874208078342, 10.20805317242403, 10.214228365658293, 10.220399794677405, 10.226567466356647, 10.232731387550396, 10.238891565092219, 10.245048005794951, 10.251200716450787, 10.257349703831377, 10.263494974687902, 10.269636535751166, 10.27577439373168, 10.281908555319754, 10.288039027185569, 10.294165815979275, 10.300288928331069, 10.306408370851274, 10.312524150130436, 10.318636272739392, 10.32474474522936, 10.33084957413202, 10.336950765959598, 10.343048327204938, 10.349142264341596, 10.355232583823904, 10.36131929208707, 10.367402395547233, 10.373481900601567, 10.379557813628338, 10.385630140987, 10.391698889018258, 10.397764064044152, 10.403825672368134, 10.409883720275147, 10.41593821403169, 10.421989159885912, 10.428036564067666, 10.434080432788601, 10.440120772242226, 10.44615758860399, 10.452190888031353, 10.45822067666386, 10.464246960623214, 10.470269746013347, 10.476289038920495, 10.482304845413264, 10.488317171542711, 10.494326023342406, 10.500331406828506, 10.50633332799983, 10.512331792837916, 10.518326807307105, 10.524318377354604, 10.53030650891055, 10.53629120788809, 10.542272480183437, 10.548250331675945, 10.554224768228174, 10.560195795685962, 10.566163419878482, 10.572127646618315, 10.578088481701515, 10.584045930907678, 10.59, 10.595950694725348, 10.60189802081432, 10.607841983981315, 10.613782589924593, 10.619719844326344, 10.625653752852738, 10.631584321154007, 10.637511554864494, 10.643435459602717, 10.649356040971437, 10.655273304557719, 10.661187255932987, 10.66709790065309, 10.673005244258363, 10.678909292273685, 10.684810050208545, 10.690707523557094, 10.696601717798213, 10.702492638395562, 10.70838029079765, 10.71426468043789, 10.72014581273465, 10.726023693091324, 10.731898326896381, 10.737769719523428, 10.743637876331258, 10.74950280266392, 10.755364503850771, 10.761222985206523, 10.767078252031311, 10.772930309610748, 10.778779163215974, 10.784624818103719, 10.790467279516347, 10.796306552681928, 10.802142642814275, 10.807975555113009, 10.813805294763608, 10.819631866937467, 10.825455276791944, 10.831275529470417, 10.837092630102338, 10.842906583803284, 10.848717395675006, 10.854525070805492, 10.860329614269007, 10.866131031126153, 10.871929326423912, 10.877724505195708, 10.88351657246145, 10.889305533227589, 10.895091392487155, 10.900874155219826, 10.906653826391969, 10.91243041095668, 10.918203913853857, 10.923974340010226, 10.9297416943394, 10.935505981741931, 10.941267207105353, 10.947025375304232, 10.952780491200215, 10.958532559642078, 10.964281585465773, 10.970027573494471, 10.97577052853862, 10.981510455395982, 10.987247358851684, 10.992981243678262, 10.998712114635714, 11.004439976471536, 11.010164833920777, 11.01588669170608, 11.021605554537723, 11.027321427113678, 11.033034314119645, 11.038744220229095, 11.044451150103322, 11.050155108391486, 11.055856099730654, 11.061554128745845, 11.067249200050075, 11.072941318244398, 11.078630487917955, 11.084316713648011, 11.09, 11.09568035152757, 11.10135777277262, 11.107032268265352, 11.1127038425243, 11.118372500056388, 11.124038245356955, 11.129701082909808, 11.135361017187261, 11.141018052650171, 11.14667219374799, 11.152323444918792, 11.157971810589327, 11.163617295175051, 11.16925990308017, 11.174899638697681, 11.180536506409418, 11.186170510586074, 11.191801655587259, 11.197429945761531, 11.203055385446435, 11.208677978968543, 11.214297730643494, 11.219914644776033, 11.225528725660043, 11.231139977578597, 11.236748404803977, 11.242354011597731, 11.247956802210698, 11.253556780883054, 11.259153951844338, 11.264748319313505, 11.270339887498949, 11.275928660598547, 11.281514642799696, 11.287097838279346, 11.29267825120404, 11.298255885729947, 11.303830746002902, 11.309402836158437, 11.314972160321824, 11.3205387226081, 11.326102527122115, 11.331663577958558, 11.337221879201993, 11.3427774349269, 11.348330249197701, 11.35388032606881, 11.359427669584644, 11.36497228377968, 11.370514172678478, 11.376053340295712, 11.381589790636214, 11.387123527695003, 11.392654555457314, 11.398182877898641]
        ,[0.81, 1.1918376618407358, 1.35, 1.471362230551458, 1.5736753236814716, 1.6638149682454626, 1.7453074360871939, 1.8202474944289644, 1.8900000000000001, 1.955512985522207, 2.0174767078498865, 2.0764122551523263, 2.1327244611029164, 2.186735268670052, 2.238705707974879, 2.2888509052639487, 2.3373506473629426, 2.3843570116082313, 2.43, 2.4743917808016236, 2.517629936490925, 2.5597999885701226, 2.600977386791916, 2.6412290954438227, 2.6806148721743877, 2.7191883092036786, 2.7569976887505545, 2.7940866916543747, 2.8304949888579287, 2.8662587385832556, 2.9014110069520056, 2.9359821259831893, 2.97, 3.0034903692517094, 3.036477037833537, 3.0689820716420044, 3.101025971044414, 3.1326278221015094, 3.163805429511964, 3.1945754339085193, 3.224953415699773, 3.2549539872971027, 3.284590875276154, 3.31387699378384, 3.342824510304652, 3.3714449047363875, 3.3997490225888685, 3.427747123004818, 3.455448922205832, 3.4828636328851497, 3.5100000000000002, 3.5368663333577612, 3.5634705373401037, 3.5898201380664903, 3.6159223082615815, 3.6417838900594095, 3.667411415949758, 3.6928111280484543, 3.7179889958526324, 3.7429507326240583, 3.7677018105278974, 3.792247474640561, 3.816592755928212, 3.840742483286893, 3.8647012947258856, 3.8884736477676727, 3.9120638291305356, 3.935475963753361, 3.9587140232164626, 3.9817818336070974, 4.004683082873793, 4.027421327709506, 4.050000000000001, 4.072422412870535, 4.094691766361039, 4.116811152757291, 4.138783561603248, 4.1606118844175315, 4.182298919135135, 4.203847374293664, 4.22525987298185, 4.246538956566621, 4.267687088213739, 4.288706656215784, 4.309599977140245, 4.330369298809431, 4.3510168031230805, 4.371544608733688, 4.391954773583832, 4.41224929731411, 4.4324301235496595, 4.452499142072652, 4.472458190887645, 4.492309058186182, 4.512053484216564, 4.53169316306436, 4.551229744348776, 4.570664834839713, 4.59, 4.609236765456979, 4.628376618407357, 4.647421008959012, 4.66637135141314, 4.685229025489978, 4.7039953775011085, 4.722671721471149, 4.74125934021148, 4.759759486348504, 4.778173383308749, 4.796502226263018, 4.814747183031658, 4.832909394952862, 4.850989977715857, 4.868990022160686, 4.886910595046205, 4.904752739787838, 4.922517477166512, 4.940205806010157, 4.957818703849048, 4.975357127546209, 4.992822013904011, 5.010214280248093, 5.027534824989594, 5.044784528166694, 5.061964251966378, 5.079074841227312, 5.096117123924637, 5.1130919116374915, 5.130000000000001, 5.146842169136432, 5.163619184081217, 5.1803317951844345, 5.196980738503418, 5.213566736181024, 5.230090496811124, 5.246552715791845, 5.262954075667073, 5.27929524645665, 5.295576885975761, 5.311799640143928, 5.327964143284008, 5.344071018411599, 5.360120877515234, 5.376114321827696, 5.392051942088829, 5.4079343188001285, 5.423762022471466, 5.4395356138602065, 5.455255644203019, 5.470922655440658, 5.48653718043597, 5.502099743185347, 5.517610859023929, 5.533071034824694, 5.548480769191746, 5.5638405526479335, 5.579150867817038, 5.594412189600725, 5.609624985350418, 5.624789715034293, 5.639906831399546, 5.654976780130118, 5.67, 5.684976923022303, 5.699907974594206, 5.714793573637937, 5.729634132737923, 5.744430058274208, 5.759181750552308, 5.773889603929565, 5.78855400693816, 5.803175342404872, 5.817753987567681, 5.8322903141893345, 5.846784688667961, 5.861237472144822, 5.875649020609304, 5.890019685001231, 5.904349811310565, 5.918639740674616, 5.9328898094727744, 5.947100349418921, 5.961271687651507, 5.975404146821429, 5.989498045177736, 6.003553696651263, 6.0175714109361955, 6.031551493569703, 6.0454942460096355, 6.059399965710368, 6.0732689461968405, 6.087101477136859, 6.100897844411664, 6.114658330184895, 6.128383212969897, 6.142072767695504, 6.155727265770299, 6.169346975145386, 6.182932160375747, 6.196483082680201, 6.210000000000001, 6.223483167056125, 6.23693283540528, 6.2503492534946705, 6.263732666715523, 6.277083317455478, 6.290401445149799, 6.303687286331467, 6.316941074680207, 6.330163041070437, 6.343353413618184, 6.356512417727018, 6.36964027613298, 6.38273720894858, 6.395803433705845, 6.408839165398485, 6.421844616523163, 6.434819997119909, 6.447765514811698, 6.460681374843215, 6.4735677801188185, 6.486424931239734, 6.4992530265404795, 6.512052262124577, 6.524822831899517, 6.537564927611035, 6.550278738876711, 6.56296445321888, 6.575622256096908, 6.588252330938829, 6.600854859172349, 6.613430020255263, 6.625977991705264, 6.638498949129184, 6.650993066251663, 6.663460514943276, 6.675901465248117, 6.688316085410856, 6.700704541903287, 6.713066999450371, 6.725403621055795, 6.737714568027041, 6.75, 6.762260074963123, 6.774494949281122, 6.786704777718237, 6.798889713461087, 6.811049908141076, 6.823185511856424, 6.835296673193778, 6.847383539249433, 6.859446255650182, 6.871484966573785, 6.883499814769076, 6.895490941575709, 6.907458486943556, 6.919402589451771, 6.931323386327502, 6.943221013464296, 6.955095605440164, 6.966947295535345, 6.978776215749766, 6.990582496820183, 7.002366268237045, 7.014127658261071, 7.025866793939523, 7.037583801122231, 7.049278804477327, 7.060951927506721, 7.072603292561329, 7.084233020856015, 7.095841232484322, 7.107428046432926, 7.118993580595879, 7.1305379517885985, 7.14206127576163, 7.153563667214195, 7.165045239807503, 7.176506106177863, 7.187946377949567, 7.199366165747586, 7.210765579210037, 7.222144727000476, 7.233503716819973, 7.244842655419012, 7.256161648609195, 7.267460801274755, 7.278740217383907, 7.290000000000001, 7.301240251292507, 7.3124610725478405, 7.323662564180003, 7.334844825741069, 7.34600795593151, 7.357152052610356, 7.368277212805204, 7.379383532722077, 7.390471107755129, 7.4015400324962, 7.412590400744241, 7.423622305514581, 7.434635839048061, 7.445631092820035, 7.456608157549233, 7.467567123206495, 7.478508079023374, 7.4894311135006095, 7.500336314416488, 7.5112237688350625, 7.52209356311427, 7.532945782913917, 7.543780513203561, 7.55459783827027, 7.565397841726275, 7.576180606516502, 7.586946214926012, 7.59769474858733, 7.608426288487653, 7.619140914975986, 7.6298387077701495, 7.640519745963701, 7.651184108032762, 7.661831871842741, 7.67246311465497, 7.683077913133243, 7.69367634335026, 7.704258480794001, 7.714824400373988, 7.7253741764274775, 7.735907882725556, 7.74642559247917, 7.756927378345049, 7.767413312431568, 7.777883466304528, 7.788337910992848, 7.798776716994185, 7.809199954280489, 7.819607692303473, 7.83, 7.840376945797431, 7.850738597618861, 7.861085022888322, 7.871416288535892, 7.88173246100275, 7.8920336062461605, 7.902319789744398, 7.91259107650159, 7.9228475310525255, 7.933089217467376, 7.943316199356371, 7.9535285398743945, 7.963726301725556, 7.973909547167665, 7.984078338016669, 7.994232735651039, 8.004372801016084, 8.01449859462822, 8.02461017657919, 8.034707606540213, 8.044790943766102, 8.05486024709932, 8.064915574973979, 8.074956985419805, 8.08498453606604, 8.094998284145303, 8.1049982864974, 8.11498459957309, 8.124957279437796, 8.134916381775291, 8.144861961891307, 8.15479407471714, 8.164712774813168, 8.174618116372363, 8.184510153223739, 8.194388938835766, 8.204254526319744, 8.214106968433128, 8.223946317582831, 8.233772625828461, 8.24358594488555, 8.25338632612872, 8.26317382059482, 8.272948478986038, 8.282710351672947, 8.292459488697551, 8.302195939776269, 8.311919754302895, 8.32163098135152, 8.331329669679425, 8.341015867729931, 8.350689623635228, 8.360350985219165, 8.370000000000001, 8.379636715193142, 8.389261177713829, 8.398873434179807, 8.408473530913957, 8.4180615139469, 8.427637429019578, 8.437201321585789, 8.446753236814715, 8.4562932195934, 8.465821314529226, 8.475337565952332, 8.484842017918023, 8.494334714209163, 8.503815698338505, 8.513285013551037, 8.52274270282628, 8.53218880888055, 8.541623374169232, 8.551046440888983, 8.560458050979955, 8.569858246127954, 8.579247067766607, 8.588624557079484, 8.597990755002217, 8.607345702224572, 8.61668943919252, 8.62602200611027, 8.635343442942297, 8.644653789415331, 8.653953085020333, 8.663241369014454, 8.67251868042296, 8.681785058041156, 8.69104054043627, 8.700285165949328, 8.709518972697008, 8.718741998573478, 8.727954281252197, 8.737155858187727, 8.746346766617497, 8.755527043563568, 8.764696725834368, 8.773855850026418, 8.783004452526036, 8.792142569511022, 8.801270236952321, 8.81038749061569, 8.819494366063317, 8.828590898655449, 8.837677123551995, 8.846753075714098, 8.855818789905724, 8.864874300695202, 8.873919642456764, 8.88295484937207, 8.891979955431715, 8.900994994436717, 8.910000000000002, 8.918995005547853, 8.927980044321371, 8.936955149377903, 8.945920353592458, 8.954875689659113, 8.96382119009241, 8.972756887228726, 8.981682813227641, 8.990599000073283, 8.999505479575676, 9.008402283372048, 9.01728944292816, 9.026166989539588, 9.035034954333023, 9.04389336826753, 9.052742262135824, 9.061581666565509, 9.070411612020314, 9.079232128801321, 9.088043247048182, 9.096844996740316, 9.105637407698097, 9.114420509584038, 9.123194331903953, 9.131958904008119, 9.140714255092417, 9.149460414199472, 9.158197410219767, 9.166925271892769, 9.175644027808023, 9.184353706406245, 9.193054335980413, 9.20174594467683, 9.210428560496185, 9.219102211294617, 9.227766924784746, 9.236422728536708, 9.245069649979188, 9.253707716400422, 9.262336954949207, 9.270957392635896, 9.279569056333388, 9.288171972778095, 9.296766168570926, 9.30535167017823, 9.313928503932758, 9.322496696034602, 9.33105627255213, 9.33960725942291, 9.348149682454626, 9.356683567325984, 9.365208939587625, 9.373725824663001, 9.382234247849276, 9.390734234318181, 9.399225809116908, 9.407708997168957, 9.416183823274984, 9.424650312113661, 9.433108488242508, 9.441558376098723, 9.450000000000001, 9.458433384145362, 9.466858552615957, 9.475275529375857, 9.483684338272866, 9.492085003039305, 9.500477547292785, 9.508861994536987, 9.517238368162435, 9.525606691447246, 9.533966987557896, 9.542319279549965, 9.55066359036887, 9.558999942850612, 9.567328359722502, 9.575648863603881, 9.583961477006838, 9.59226622233692, 9.600563121893842, 9.608852197872176, 9.617133472362049, 9.625406967349836, 9.633672704718824, 9.641930706249909, 9.650180993622248, 9.658423588413928, 9.666658512102634, 9.674885786066284, 9.68310543158369, 9.691317469835205, 9.699521921903338, 9.707718808773405, 9.715908151334148, 9.724089970378357, 9.732264286603485, 9.740431120612264, 9.7485904929133, 9.756742423921683, 9.764886933959582, 9.77302404325683, 9.781153771951521, 9.789276140090582, 9.79739116763035, 9.80549887443715, 9.813599280287857, 9.821692404870465, 9.829778267784638, 9.837856888542264, 9.845928286568018, 9.853992481199883, 9.862049491689715, 9.87009933720376, 9.8781420368232, 9.88617760954467, 9.894206074280792, 9.902227449860678, 9.91024175503047, 9.91824900845382, 9.926249228712432, 9.934242434306535, 9.942228643655394, 9.95020787509781, 9.958180146892605, 9.966145477219113, 9.974103884177657, 9.982055385790037, 9.99, 9.99793774467372, 10.005868637600258, 10.013792696492029, 10.02170993898527, 10.029620382640493, 10.037524044942934, 10.04542094330302, 10.053311095056793, 10.061194517466381, 10.069071227720414, 10.076941242934478, 10.084804580151541, 10.092661256342387, 10.100511288406038, 10.108354693170185, 10.116191487391607, 10.124021687756585, 10.131845310881317, 10.139662373312339, 10.147472891526915, 10.155276881933462, 10.16307436087194, 10.170865344614247, 10.178649849364636, 10.186427891260083, 10.194199486370694, 10.201964650700088, 10.209723400185776, 10.217475750699547, 10.225221718047857, 10.23296131797218, 10.24069456614941, 10.24842147819221, 10.256142069649387, 10.263856356006263, 10.271564352685026, 10.279266075045099, 10.286961538383494, 10.29465075793516, 10.302333748873354, 10.31001052630996, 10.317681105295867, 10.325345500821292, 10.333003727816136, 10.340655801150309, 10.348301735634077, 10.355941546018393, 10.363575246995232, 10.37120285319792, 10.37882437920145, 10.38643983952283, 10.39404924862138, 10.401652620899071, 10.409249970700836, 10.416841312314887, 10.424426659973024, 10.432006027850951, 10.439579430068585, 10.447146880690365, 10.454708393725547, 10.46226398312852, 10.469813662799092, 10.477357446582806, 10.484895348271216, 10.492427381602198, 10.499953560260236, 10.507473897876705, 10.514988408030172, 10.522497104246673, 10.530000000000001, 10.537497108711985, 10.544988443752771, 10.552474018441108, 10.559953846044607, 10.567427939780034, 10.574896312813568, 10.582358978261084, 10.589815949188411, 10.597267238611606, 10.60471285949721, 10.612152824762529, 10.619587147275874, 10.627015839856837, 10.634438915276538, 10.641856386257889, 10.649268265475845, 10.656674565557655, 10.664075299083118, 10.671470478584824, 10.678860116548417, 10.686244225412818, 10.693622817570489, 10.70099590536767, 10.708363501104616, 10.715725617035837, 10.723082265370344, 10.730433458271873, 10.737779207859129, 10.745119526206015, 10.752454425341863, 10.75978391725167, 10.767108013876319, 10.774426727112806, 10.78174006881447, 10.789048050791218, 10.796350684809743, 10.803647982593745, 10.810939955824155, 10.818226616139345, 10.825507975135361, 10.832784044366116, 10.840054835343624, 10.847320359538198, 10.85458062837867, 10.861835653252596, 10.869085445506466, 10.876330016445914, 10.883569377335922, 10.890803539401016, 10.89803251382548, 10.905256311753556, 10.912474944289643, 10.919688422498492, 10.926896757405405, 10.934099959996445, 10.941298041218609, 10.948491011980037, 10.955678883150206, 10.962861665560112, 10.970039370002462, 10.977212007231877, 10.984379587965059, 10.991542122880995, 10.998699622621132, 11.005852097789571, 11.012999558953242, 11.020142016642081, 11.027279481349233, 11.034411963531204, 11.041539473608065, 11.048662021963613, 11.05577961894555, 11.062892274865664, 11.070000000000002, 11.077102804589035, 11.084200698837842, 11.091293692916278, 11.098381796959131, 11.105465021066316, 11.112543375303014, 11.119616869699865, 11.126685514253113, 11.133749318924789, 11.140808293642857, 11.14786244830139, 11.15491179276073, 11.161956336847641, 11.168996090355474, 11.176031063044332, 11.183061264641216, 11.190086704840187, 11.197107393302527, 11.204123339656885, 11.211134553499441, 11.218141044394047, 11.225142821872392, 11.232139895434143, 11.239132274547103, 11.246119968647353, 11.253102987139407, 11.26008133939636, 11.267055034760027, 11.274024082541095, 11.280988492019272, 11.287948272443419, 11.294903433031704, 11.301853982971744, 11.308799931420735, 11.31574128750561, 11.322678060323165, 11.329610258940207, 11.33653789239368, 11.343460969690828, 11.350379499809295, 11.35729349169729, 11.364202954273717, 11.371107896428292, 11.378008327021702, 11.384904254885717, 11.39179568882333, 11.398682637608893, 11.405565109988236, 11.412443114678805, 11.419316660369791, 11.426185755722251, 11.433050409369242, 11.439910629915946, 11.446766425939794, 11.453617805990595, 11.460464778590653, 11.467307352234899, 11.47414553539101, 11.480979336499534, 11.487808763974003, 11.494633826201065, 11.501454531540599, 11.508270888325834, 11.515082904863466, 11.521890589433783, 11.528693950290773, 11.535492995662251, 11.542287733749967, 11.549078172729725, 11.555864320751496, 11.562646185939535, 11.56942377639249, 11.576197100183519, 11.582966165360403, 11.589730979945651, 11.596491551936618, 11.603247889305612, 11.610000000000001, 11.616747891942332, 11.623491573030426, 11.630231051137496, 11.63696633411225, 11.643697429778996, 11.650424345937756, 11.65714709036436, 11.663865670810562, 11.670580095004134, 11.67729037064898, 11.683996505425226, 11.69069850698934, 11.697396382974215, 11.70409014098929, 11.710779788620629, 11.717465333431045, 11.72414678296018, 11.730824144724611, 11.737497426217955, 11.744166634910957, 11.7508317782516, 11.75749286366518, 11.764149898554429, 11.770802890299597, 11.777451846258549, 11.784096773766851, 11.79073768013789, 11.797374572662935, 11.804007458611261, 11.810636345230217, 11.817261239745337, 11.823882149360415, 11.830499081257619, 11.837112042597555, 11.843721040519378, 11.850326082140873, 11.856927174558544, 11.86352432484771, 11.870117540062584, 11.876706827236367, 11.883292193381335, 11.889873645488926, 11.896451190529817, 11.903024835454037, 11.909594587191012, 11.916160452649693, 11.922722438718607, 11.929280552265961, 11.93583480013972, 11.942385189167686, 11.948931726157586, 11.95547441789716, 11.962013271154227, 11.968548292676786, 11.97507948919308, 11.98160686741169, 11.988130434021606, 11.99465019569231, 12.001166159073863, 12.00767833079697, 12.014186717473072, 12.020691325694417, 12.027192162034135, 12.033689233046326, 12.040182545266129, 12.046672105209801, 12.053157919374788, 12.059639994239818, 12.066118336264951, 12.072592951891675, 12.079063847542974, 12.085531029623397, 12.091994504519137, 12.098454278598114, 12.104910358210022, 12.11136274968643, 12.11781145934084, 12.124256493468762, 12.130697858347782, 12.137135560237638, 12.143569605380293, 12.15, 12.156426750303376, 12.162849862479467, 12.169269342699822, 12.175685197118563, 12.182097431872453, 12.188506053080959, 12.194911066846329, 12.201312479253655, 12.207710296370935, 12.214104524249153, 12.220495168922337, 12.226882236407628, 12.23326573270534, 12.239645663799033, 12.246022035655582, 12.25239485422523, 12.258764125441663, 12.26512985522207, 12.271492049467208, 12.277850714061465, 12.284205854872921, 12.290557477753424, 12.296905588538632, 12.303250193048093, 12.309591297085303, 12.31592890643776, 12.322263026877035, 12.328593664158834, 12.334920824023046, 12.341244512193818, 12.34756473437961, 12.353881496273253, 12.360194803552018, 12.366504661877658, 12.372811076896484, 12.379114054239418, 12.385413599522051, 12.391709718344698, 12.398002416292465, 12.404291698935301, 12.410577571828052, 12.416860040510526, 12.423139110507549, 12.429414787329009, 12.435687076469932, 12.44195598341053, 12.448221513616247, 12.454483672537826, 12.460742465611366, 12.466997898258368, 12.473249975885796, 12.479498703886128, 12.485744087637414, 12.491986132503328, 12.498224843833217, 12.504460226962166, 12.510692287211045, 12.516921029886554, 12.523146460281287, 12.529368583673783, 12.535587405328572, 12.541802930496234, 12.548015164413446, 12.554224112303036, 12.560429779374031, 12.56663217082171, 12.572831291827663, 12.57902714755982, 12.585219743172525, 12.591409083806573, 12.59759517458926, 12.603778020634442, 12.609957627042567, 12.616133998900743, 12.622307141282773, 12.628477059249217, 12.634643757847424, 12.64080724211159, 12.646967517062807, 12.653124587709108, 12.659278459045515, 12.665429136054081, 12.67157662370395, 12.677720926951393, 12.683862050739853, 12.690000000000001, 12.696134779649777, 12.70226639459443, 12.70839484972658, 12.714520149926246, 12.7206423000609, 12.726761304985512, 12.732877169542594, 12.738989898562243, 12.745099496862187, 12.751205969247831, 12.757309320512297, 12.763409555436475, 12.769506678789057, 12.775600695326585, 12.781691609793498, 12.787779426922173, 12.793864151432961, 12.799945788034242, 12.806024341422455, 12.812099816282151, 12.818172217286028, 12.824241549094975, 12.830307816358117, 12.836371023712848, 12.842431175784885, 12.848488277188297, 12.85454233252555, 12.860593346387555, 12.866641323353699, 12.872686267991886, 12.878728184858586, 12.884767078498866, 12.890802953446432, 12.896835814223673, 12.902865665341695, 12.908892511300364, 12.914916356588344, 12.920937205683135, 12.926955063051114, 12.932969933147572, 12.93898182041675, 12.944990729291886, 12.950996664195245, 12.956999629538153, 12.962999629721054, 12.968996669133519, 12.974990752154316, 12.980981883151417, 12.986970066482057, 12.992955306492757, 12.998937607519371, 13.004916973887113, 13.010893409910604, 13.0168669198939, 13.022837508130534]
    ]
    sigma_map = np.array(sigma_map, dtype=np.float32)
    noise_map = np.zeros((raw_h, raw_w), dtype=np.float32)

    for i in range(4):
        raw_buf_ch = np.array(raw_buf*bayer_mask[i], dtype=raw_buf.dtype)
        sigma = sigma_map[i][raw_buf_ch]
        noise_map += np.random.normal(0, sigma, (raw_h, raw_w))

    noise_map *= noise_scale

    # print('Noise range: ', np.min(noise_map), np.max(noise_map))

    raw_out = np.array(raw_buf, dtype=np.float32) + noise_map
    raw_out = np.clip(raw_out, 0, bit_chart[bitrate]-1)

    raw_out = np.array(raw_out, dtype=raw_buf.dtype)

    return raw_out


# Downscale Bayer raw by 2x. HOPEFULLY retaining original noise distribution
# while preventing false color.
def bayer_raw_downscale(raw_buf):

    raw_h, raw_w = raw_buf.shape

    offset = [[0, 0], [0, 1], [1, 0], [1, 1]]
    grid_weights = [[8, 3, 3, 2], [3, 8, 2, 3], [3, 2, 8, 3], [
        2, 3, 3, 8]]  # Stolen from "Bayer Consistent Raw Scaling"

    raw_out = np.zeros((int(raw_h/2), int(raw_w/2)), dtype=raw_buf.dtype)

    for idx in range(4):
        raw_pix = raw_buf[0+offset[idx][0]::2, 0+offset[idx][1]::2]
        raw_pix_sub_src = np.array(
            [raw_pix[ii[0]::2, ii[1]::2] for ii in offset], dtype=raw_buf.dtype)

        '''
		# Random Mapping. There must be a faster way.

		rand_map = np.random.randint(4, size=raw_pix_sub_src[0].shape)
		raw_pix_sub = np.zeros(raw_pix_sub_src[0].shape, dtype=raw_buf.dtype)

		for u in range(raw_pix_sub_src[0].shape[0]):
			for v in range(raw_pix_sub_src[0].shape[1]):
				raw_pix_sub[u][v] = raw_pix_sub_src[rand_map[u][v]][u][v]
		'''

        # Weighted sum
        raw_pix_sub = np.array(np.average(
            raw_pix_sub_src, axis=0, weights=grid_weights[idx]), dtype=raw_buf.dtype)

        # Max value
        #raw_pix_sub = np.array(np.max(raw_pix_sub_src, axis=0), dtype=raw_buf.dtype)

        # Pixel Skipping
        #raw_pix_sub = raw_pix_sub_src[0]

        # Write output
        raw_out[0+offset[idx][0]::2, 0+offset[idx][1]::2] = raw_pix_sub

    return raw_out

# Bayer raw directy convert to 3-channel BGR image
# Pad [pad_value] to "empty" pixels.
# This is also the input format for AIDM.


def bayer_to_bgr(raw, pattern='RGGB', pad_value=0):
    h, w = raw.shape
    if pattern == 0 or pattern == 'GRBG':
        num = [1, 0, 2, 1]  # GRBG
    elif pattern == 1 or pattern == 'GBRG':
        num = [1, 2, 0, 1]  # GBRG
    elif pattern == 2 or pattern == 'RGGB':
        num = [0, 1, 1, 2]  # RGGB
    elif pattern == 3 or pattern == 'BGGR':
        num = [2, 1, 1, 0]  # BGGR
    elif pattern:
        print('Error: invalid pattern!')
        exit()

    rgb = np.zeros((h, w, 3), dtype=raw.dtype)+pad_value
    rgb[0:h:2, 0:w:2, num[0]] = raw[0:h:2, 0:w:2]
    rgb[0:h:2, 1:w:2, num[1]] = raw[0:h:2, 1:w:2]
    rgb[1:h:2, 0:w:2, num[2]] = raw[1:h:2, 0:w:2]
    rgb[1:h:2, 1:w:2, num[3]] = raw[1:h:2, 1:w:2]

    bgr = rgb[:, :, ::-1]

    return bgr


def bayer_to_bgr2(raw, pattern='RGGB', pad_value=0):
    raw_h, raw_w = raw.shape
    r_mask, g_mask, b_mask = bayer_mask_gen(raw_w, raw_h, pattern)

    bgr = np.zeros((raw_h, raw_w, 3), dtype=raw.dtype)

    #bgr[...,0] = raw*b_mask
    #bgr[...,1] = raw*g_mask
    bgr[..., 2] = raw*r_mask

    return bgr

# Normalize raw file to 0~1 float32, with input_max = 2^bitrate (to np.max(raw_buf) if bitrate=0)
# Black level: the "floor" of the output. This is reduced to 0 and the rest it normalized.


def raw_normalize(raw_buf, black_level=0, bitrate=10):
    if bitrate == 0:
        raw_max = (np.max(raw_buf)-black_level)
    else:
        raw_max = (bit_chart[bitrate]-black_level)

    # print('black_level:', black_level)
    # print('raw_max: ', raw_max)
    raw_buf2 = deepcopy(raw_buf).astype(np.float32) - black_level
    raw_buf2 = np.clip(raw_buf2, 0, raw_max)

    return np.array(raw_buf2/raw_max, dtype=np.float32)

# Quantize float raw file (range(0~1)) to desired bitrate. Returns uint8 or uint16 buffer.


def raw_quantize(raw_buf, bitrate=10):
    if bitrate <= 8:
        return np.array(np.clip(raw_buf, 0, 1)*(bit_chart[bitrate]-1)+0.5, dtype=np.uint8)
    else:
        return np.array(np.clip(raw_buf, 0, 1)*(bit_chart[bitrate]-1)+0.5, dtype=np.uint16)

# Crop bayer raw. Automatically round to %2 pixels to preserve pattern.


def bayer_raw_crop(raw_buf, x1, y1, x2, y2):
    # Not sure if deepcopy is necessary here, but anyway.
    return deepcopy(raw_buf[y1+(y1 % 2):y2-(y2 % 2), x1+(x1 % 2):x2-(x2 % 2)])

# Get the average value of each channel.


def bayer_check_RGB_avg(raw_buf, pattern='RGGB'):
    raw_w = raw_buf.shape[1]
    raw_h = raw_buf.shape[0]
    r_mask, g_mask, b_mask = bayer_mask_gen(raw_w, raw_h, pattern)

    g_avg = np.sum(raw_buf*g_mask) / np.sum(g_mask)
    b_avg = np.sum(raw_buf*b_mask) / np.sum(b_mask)
    r_avg = np.sum(raw_buf*r_mask) / np.sum(r_mask)
    return r_avg, g_avg, b_avg

# Get the average value of green channel. Legacy.


def bayer_check_green_avg(raw_buf, pattern='RGGB'):
    _, g_avg, _ = bayer_check_RGB_avg(raw_buf, pattern)
    return g_avg


# Generate gamma LUT
# Precision/size set to 2^bitrate.
# tail2: The linear/"straight" tail of the gamma curve. Normalized to 0~1.
def gamma_LUT_gen(gamma=1.0, tail=0.0, bitrate=10):
    invGamma = 1.0 / gamma

    out_type = np.uint8
    if bitrate > 8:
        out_type = np.uint16

    table = np.array([((i / (bit_chart[bitrate]-1)) ** invGamma) * (bit_chart[bitrate]-1)
                      for i in np.arange(0, bit_chart[bitrate])]).astype(out_type)
    # apply gamma correction using the lookup table

    tail_idx = int(tail*bit_chart[bitrate])
    tail_end = table[tail_idx]
    tail_slope = tail_end/tail_idx

    '''
	print('tail_idx: ', tail_idx)
	print('tail_end: ', tail_end)
	print('tail_slope: ', tail_slope)
	'''
    table[0:tail_idx] = [(ii * tail_slope).astype(out_type)
                         for ii in range(tail_idx)]

    return table


# Generate simple Global Tone Mapping (3x^2 - 2x^3)
# Precision/size set to 2^bitrate.
# tail2: The linear/"straight" tail of the gamma curve. Normalized to 0~1.
def gtm_LUT_gen(bitrate=10):
    out_type = np.uint8
    if bitrate > 8:
        out_type = np.uint16

    range = bit_chart[bitrate]-1

    table = np.array([(3*(i/range)**2 - 2*(i/range)**3) * (range)
                      for i in np.arange(0, bit_chart[bitrate])]).astype(out_type)

    return table


# Apply 3x3 color correction matrix.
# input: rgb image buffer, normalized.
def rgb_apply_ccm(rgb_buf_float, ccm):
    #img_h, img_w, _ = rgb_buf_float.shape
    rgb_buf_flat = np.reshape(
        rgb_buf_float, (rgb_buf_float.shape[0]*rgb_buf_float.shape[1], 3))
    out_buf = np.matmul(rgb_buf_flat, ccm)
    out_buf = np.clip(out_buf, 0, 1)
    out_buf = np.reshape(out_buf, rgb_buf_float.shape)
    return out_buf


# Apply LSC via gain map.
# Gain map: same resolution as raw_buf (bgr)
def bayer_raw_LSC(raw_buf_float, gain_map, pattern='RGGB'):
    raw_w = raw_buf_float.shape[1]
    raw_h = raw_buf_float.shape[0]
    r_mask, g_mask, b_mask = bayer_mask_gen(raw_w, raw_h, pattern)

    r_buf = raw_buf_float * r_mask * gain_map[:, :, 2]
    g_buf = raw_buf_float * g_mask * gain_map[:, :, 1]
    b_buf = raw_buf_float * b_mask * gain_map[:, :, 0]

    out_buf = r_buf + g_buf + b_buf

    return out_buf


# Tests

if __name__ == '__main__':

    import run_JDNDMSR
    import cv2

    # h5_name = '0420114014.h5' # First version with noise map
    # h5_name = '0422131130.h5' # Using Peter's RGB->RAW convert model
    h5_name = '0422151838.h5'  # Trained with original RGB->RAW augmentation
    # h5_name = '0427172113.h5' # SIDD small (100) dataset, Bilinear demosaic GT

    # run_JDNDMSR.init('0414165516.h5')
    #run_JDNDMSR.init('0420114014.h5', noise=True)
    run_JDNDMSR.init(h5_name, noise=True)

    model_basename = os.path.splitext(h5_name)[0]

    #raw_file = 'H:/20220413_OV02740/test4/G8_018.raw'
    #raw_file = 'H:/20220413_OV02740/test4/G1_140.raw'
    #raw_file = 'H:/20220413_OV02740/Color Chart/3100K/G1_500ms.raw'
    #raw_w, raw_h = 1928,1088

    #raw_file = 'H:\\20220417_PiCamera\\focus2\\20220419114410616015_3280_2464_ISO_50_exp_28006.raw'
    raw_file = 'H:\\20220417_PiCamera\\focus2\\20220419142240753512_3280_2464_ISO_50_exp_69992.raw'
    #raw_file = 'H:\\20220417_PiCamera\\noise_mf2\\20220419150133207016_3280_2464_ISO_50_exp_28403_0000.raw'
    #raw_file = 'H:\\20220417_PiCamera\\charts_2\\5000k\\20220417213114304585_3280_2464_ISO_800_exp_12486.raw'
    raw_w, raw_h = 3280, 2464

    raw_pattern = 'BGGR'

    basename = os.path.splitext(os.path.basename(raw_file))[0]

    cv_winname = basename
    cv2.namedWindow(cv_winname, cv2.WINDOW_NORMAL)

    raw_buf = np.fromfile(raw_file, dtype=np.uint16)
    raw_buf = np.reshape(raw_buf, (raw_h, raw_w))

    raw_buf_float = raw_normalize(raw_buf, black_level=64, bitrate=10)

    gain_map = np.load('pi_camera_LSC_gain.npy')
    raw_buf_float = bayer_raw_LSC(raw_buf_float, gain_map, 'BGGR')

    # print('RAW g-average: ', bayer_check_green_avg(raw_buf, raw_pattern))
    # print('RAW_float g-average: ',
    #       bayer_check_green_avg(raw_buf_float, raw_pattern))

    # print(np.min(raw_buf), np.max(raw_buf))
    # print(np.min(raw_buf_float), np.max(raw_buf_float))

    #bgr_buf = cv2.cvtColor(raw_quantize(raw_buf_float, 8), cv2.COLOR_BAYER_RG2BGR)
    bgr_buf = cv2.cvtColor(raw_quantize(raw_buf_float, 8),
                           cv2.COLOR_BAYER_RG2BGR_VNG)

    cv2.imshow(cv_winname, bgr_buf)
    cv2.imwrite(basename+'_dm.webp', bgr_buf, [cv2.IMWRITE_WEBP_QUALITY, 100])
    cv2.waitKeyEx(100)

    '''
	##### color temp test

	out_buf = np.zeros((50,800,3), dtype=np.float32)
	for ii in range(800):
		color_temp = ii*10 + 1000
		out_buf[:,ii,:] = white_color_temp(color_temp)

	out_buf = cv2.cvtColor(out_buf, cv2.COLOR_RGB2BGR)
	cv2.imshow(cv_winname, out_buf)
	cv2.waitKeyEx(0)
	'''
    # White balance test

    from raw_util_wb import *

    #raw_buf_float = bayer_raw_downscale(raw_buf_float)

    # wb = bayer_calc_wb_crop(raw_buf_float, 838, 800, 855, 816, raw_pattern, 6500) # test5
    # wb = bayer_calc_wb_crop(raw_buf_float, 1404, 247, 1541, 377, raw_pattern, 6500) # color chart

    #wb = bayer_calc_wb_grayworld(raw_buf_float, raw_pattern, 6500)
    wb = bayer_calc_wb_whitepatch(raw_buf_float, raw_pattern, 0)

    #raw_buf_float = bayer_raw_downscale(raw_buf_float)

    raw_buf_float_wb = bayer_apply_wb(
        raw_buf_float, wb[0], wb[1], wb[2], raw_pattern)

    #np.save(basename+'_wb.npy', raw_buf_float_wb)

    #bgr_buf = cv2.cvtColor(raw_quantize(raw_buf_float_wb, 8), cv2.COLOR_BAYER_RG2BGR)
    bgr_buf = cv2.cvtColor(raw_quantize(
        raw_buf_float_wb, 8), cv2.COLOR_BAYER_RG2BGR_VNG)

    cv2.imshow(cv_winname, bgr_buf)
    cv2.imwrite(basename+'_dm_wb.webp', bgr_buf,
                [cv2.IMWRITE_WEBP_QUALITY, 100])
    cv2.waitKeyEx(100)

    # JDNDMSR

    raw_buf_input = raw_buf_float_wb[::-1, ::-1]  # Rotate 180 for BGGR->RGGB
    bgr_buf_JDNDMSR = run_JDNDMSR.run_JDNDMSR(raw_buf_input)

    # SAVE JDNDMSR RESULT!!!!
    rgb_buf8 = np.array(bgr_buf_JDNDMSR[::-1, ::-1, :]*255, dtype=np.uint8)
    out_filename = basename + '_wb_JDNDMSR_%s.png' % (model_basename)
    #cv2.imwrite(out_filename, rgb_buf8)

    ###

    # VNG dm only accepts 8U. Pity.
    raw_buf16 = raw_quantize(raw_buf_float_wb, 8)

    # CCM + Gamma correction test

    #bgr_buf = cv2.cvtColor(raw_buf16, cv2.COLOR_BAYER_RG2BGR_VNG)
    #rgb_buf = cv2.cvtColor(bgr_buf, cv2.COLOR_BGR2RGB)
    #rgb_buf_float = np.array(rgb_buf/255.0, dtype=np.float32)

    from run_AIDM import *
    raw_buf16 = raw_buf_float_wb[::-1, ::-1]  # Rotate 180 for BGGR->RGGB
    rgb_buf_float = run_AIDM_wsl_bin(raw_buf16, 10)
    rgb_buf_float = rgb_buf_float[::-1, ::-1]

    ccm = np.load('test_ccm.npy')
    rgb_buf_cc = rgb_apply_ccm(rgb_buf_float, ccm)
    rgb_buf_cc = np.clip(rgb_buf_cc, 0, 1)
    rgb_buf16 = np.array(rgb_buf_cc*65535, dtype=np.uint16)

    bgr_buf = cv2.cvtColor(rgb_buf16, cv2.COLOR_RGB2BGR)
    cv2.imshow(cv_winname, bgr_buf)
    cv2.imwrite(basename+'_aidm_wb_cc.webp', bgr_buf /
                256, [cv2.IMWRITE_WEBP_QUALITY, 100])
    cv2.waitKeyEx(100)

    gamma_LUT = gamma_LUT_gen(2.2, 0.0, 16)
    rgb_buf16 = gamma_LUT[rgb_buf16]

    gtm_LUT = gtm_LUT_gen(16)
    rgb_buf16 = gtm_LUT[rgb_buf16]

    #bgr_buf = gamma_LUT[bgr_buf]
    bgr_buf = cv2.cvtColor(rgb_buf16, cv2.COLOR_RGB2BGR)

    cv2.imshow(cv_winname, bgr_buf)
    cv2.imwrite(basename+'_aidm_wb_cc_gtm.webp', bgr_buf /
                256, [cv2.IMWRITE_WEBP_QUALITY, 100])
    cv2.waitKeyEx(100)

    bgr_buf_2x = cv2.resize(
        bgr_buf, (bgr_buf.shape[1]*2, bgr_buf.shape[0]*2), interpolation=cv2.INTER_CUBIC)
    cv2.imwrite(basename+'_aidm_wb_cc_gtm_2x.webp',
                bgr_buf_2x/256, [cv2.IMWRITE_WEBP_QUALITY, 100])

    # JDNDMSR post processing

    # CCM + Gamma correction test

    bgr_buf = np.array(bgr_buf_JDNDMSR[::-1, ::-1, :] * 65535, dtype=np.uint16)

    rgb_buf = cv2.cvtColor(bgr_buf, cv2.COLOR_BGR2RGB)
    rgb_buf_float = np.array(rgb_buf/65535.0, dtype=np.float32)
    ccm = np.load('test_ccm.npy')
    rgb_buf_cc = rgb_apply_ccm(rgb_buf_float, ccm)
    rgb_buf_cc = np.clip(rgb_buf_cc, 0, 1)
    rgb_buf16 = np.array(rgb_buf_cc*65535, dtype=np.uint16)

    bgr_buf = cv2.cvtColor(rgb_buf16, cv2.COLOR_RGB2BGR)
    cv2.imshow(cv_winname, bgr_buf)
    #cv2.imwrite(basename+'_wb_JDNDMSR_%s_cc.png'%(model_basename), bgr_buf/256)
    cv2.waitKeyEx(100)

    gamma_LUT = gamma_LUT_gen(2.2, 0.0, 16)
    rgb_buf16 = gamma_LUT[rgb_buf16]

    gtm_LUT = gtm_LUT_gen(16)
    rgb_buf16 = gtm_LUT[rgb_buf16]

    #bgr_buf = gamma_LUT[bgr_buf]
    bgr_buf = cv2.cvtColor(rgb_buf16, cv2.COLOR_RGB2BGR)

    cv2.imshow(cv_winname, bgr_buf)
    cv2.imwrite(basename+'_wb_JDNDMSR_%s_cc_gtm.webp' %
                (model_basename), bgr_buf/256, [cv2.IMWRITE_WEBP_QUALITY, 100])
    cv2.waitKeyEx(100)

    pass
